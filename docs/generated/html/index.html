<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <!--[if IE]>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="Asciidoctor 1.5.6.1" name="generator">
    <title>Systemdokumentasjon: Foreldrepenger</title>
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"
          rel="stylesheet">
    <style>
        /* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
        /* Remove comment around @import statement below when using as a custom stylesheet */
        /*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
        article, aside, details, figcaption, figure, footer, header, hgroup, main, nav, section, summary {
            display: block
        }

        audio, canvas, video {
            display: inline-block
        }

        audio:not([controls]) {
            display: none;
            height: 0
        }

        [hidden], template {
            display: none
        }

        script {
            display: none !important
        }

        html {
            font-family: sans-serif;
            -ms-text-size-adjust: 100%;
            -webkit-text-size-adjust: 100%
        }

        a {
            background: transparent
        }

        a:focus {
            outline: thin dotted
        }

        a:active, a:hover {
            outline: 0
        }

        h1 {
            font-size: 2em;
            margin: .67em 0
        }

        abbr[title] {
            border-bottom: 1px dotted
        }

        b, strong {
            font-weight: bold
        }

        dfn {
            font-style: italic
        }

        hr {
            -moz-box-sizing: content-box;
            box-sizing: content-box;
            height: 0
        }

        mark {
            background: #ff0;
            color: #000
        }

        code, kbd, pre, samp {
            font-family: monospace;
            font-size: 1em
        }

        pre {
            white-space: pre-wrap
        }

        q {
            quotes: "\201C" "\201D" "\2018" "\2019"
        }

        small {
            font-size: 80%
        }

        sub, sup {
            font-size: 75%;
            line-height: 0;
            position: relative;
            vertical-align: baseline
        }

        sup {
            top: -.5em
        }

        sub {
            bottom: -.25em
        }

        img {
            border: 0
        }

        svg:not(:root) {
            overflow: hidden
        }

        figure {
            margin: 0
        }

        fieldset {
            border: 1px solid silver;
            margin: 0 2px;
            padding: .35em .625em .75em
        }

        legend {
            border: 0;
            padding: 0
        }

        button, input, select, textarea {
            font-family: inherit;
            font-size: 100%;
            margin: 0
        }

        button, input {
            line-height: normal
        }

        button, select {
            text-transform: none
        }

        button, html input[type="button"], input[type="reset"], input[type="submit"] {
            -webkit-appearance: button;
            cursor: pointer
        }

        button[disabled], html input[disabled] {
            cursor: default
        }

        input[type="checkbox"], input[type="radio"] {
            box-sizing: border-box;
            padding: 0
        }

        input[type="search"] {
            -webkit-appearance: textfield;
            -moz-box-sizing: content-box;
            -webkit-box-sizing: content-box;
            box-sizing: content-box
        }

        input[type="search"]::-webkit-search-cancel-button, input[type="search"]::-webkit-search-decoration {
            -webkit-appearance: none
        }

        button::-moz-focus-inner, input::-moz-focus-inner {
            border: 0;
            padding: 0
        }

        textarea {
            overflow: auto;
            vertical-align: top
        }

        table {
            border-collapse: collapse;
            border-spacing: 0
        }

        *, *:before, *:after {
            -moz-box-sizing: border-box;
            -webkit-box-sizing: border-box;
            box-sizing: border-box
        }

        html, body {
            font-size: 100%
        }

        body {
            background: #fff;
            color: rgba(0, 0, 0, .8);
            padding: 0;
            margin: 0;
            font-family: "Noto Serif", "DejaVu Serif", serif;
            font-weight: 400;
            font-style: normal;
            line-height: 1;
            position: relative;
            cursor: auto;
            tab-size: 4;
            -moz-osx-font-smoothing: grayscale;
            -webkit-font-smoothing: antialiased
        }

        a:hover {
            cursor: pointer
        }

        img, object, embed {
            max-width: 100%;
            height: auto
        }

        object, embed {
            height: 100%
        }

        img {
            -ms-interpolation-mode: bicubic
        }

        .left {
            float: left !important
        }

        .right {
            float: right !important
        }

        .text-left {
            text-align: left !important
        }

        .text-right {
            text-align: right !important
        }

        .text-center {
            text-align: center !important
        }

        .text-justify {
            text-align: justify !important
        }

        .hide {
            display: none
        }

        img, object, svg {
            display: inline-block;
            vertical-align: middle
        }

        textarea {
            height: auto;
            min-height: 50px
        }

        select {
            width: 100%
        }

        .center {
            margin-left: auto;
            margin-right: auto
        }

        .spread {
            width: 100%
        }

        p.lead, .paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p {
            font-size: 1.21875em;
            line-height: 1.6
        }

        .subheader, .admonitionblock td.content > .title, .audioblock > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .stemblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, table.tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title {
            line-height: 1.45;
            color: #7a2518;
            font-weight: 400;
            margin-top: 0;
            margin-bottom: .25em
        }

        div, dl, dt, dd, ul, ol, li, h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6, pre, form, p, blockquote, th, td {
            margin: 0;
            padding: 0;
            direction: ltr
        }

        a {
            color: #2156a5;
            text-decoration: underline;
            line-height: inherit
        }

        a:hover, a:focus {
            color: #1d4b8f
        }

        a img {
            border: none
        }

        p {
            font-family: inherit;
            font-weight: 400;
            font-size: 1em;
            line-height: 1.6;
            margin-bottom: 1.25em;
            text-rendering: optimizeLegibility
        }

        p aside {
            font-size: .875em;
            line-height: 1.35;
            font-style: italic
        }

        h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 {
            font-family: "Open Sans", "DejaVu Sans", sans-serif;
            font-weight: 300;
            font-style: normal;
            color: #ba3925;
            text-rendering: optimizeLegibility;
            margin-top: 1em;
            margin-bottom: .5em;
            line-height: 1.0125em
        }

        h1 small, h2 small, h3 small, #toctitle small, .sidebarblock > .content > .title small, h4 small, h5 small, h6 small {
            font-size: 60%;
            color: #e99b8f;
            line-height: 0
        }

        h1 {
            font-size: 2.125em
        }

        h2 {
            font-size: 1.6875em
        }

        h3, #toctitle, .sidebarblock > .content > .title {
            font-size: 1.375em
        }

        h4, h5 {
            font-size: 1.125em
        }

        h6 {
            font-size: 1em
        }

        hr {
            border: solid #ddddd8;
            border-width: 1px 0 0;
            clear: both;
            margin: 1.25em 0 1.1875em;
            height: 0
        }

        em, i {
            font-style: italic;
            line-height: inherit
        }

        strong, b {
            font-weight: bold;
            line-height: inherit
        }

        small {
            font-size: 60%;
            line-height: inherit
        }

        code {
            font-family: "Droid Sans Mono", "DejaVu Sans Mono", monospace;
            font-weight: 400;
            color: rgba(0, 0, 0, .9)
        }

        ul, ol, dl {
            font-size: 1em;
            line-height: 1.6;
            margin-bottom: 1.25em;
            list-style-position: outside;
            font-family: inherit
        }

        ul, ol {
            margin-left: 1.5em
        }

        ul li ul, ul li ol {
            margin-left: 1.25em;
            margin-bottom: 0;
            font-size: 1em
        }

        ul.square li ul, ul.circle li ul, ul.disc li ul {
            list-style: inherit
        }

        ul.square {
            list-style-type: square
        }

        ul.circle {
            list-style-type: circle
        }

        ul.disc {
            list-style-type: disc
        }

        ol li ul, ol li ol {
            margin-left: 1.25em;
            margin-bottom: 0
        }

        dl dt {
            margin-bottom: .3125em;
            font-weight: bold
        }

        dl dd {
            margin-bottom: 1.25em
        }

        abbr, acronym {
            text-transform: uppercase;
            font-size: 90%;
            color: rgba(0, 0, 0, .8);
            border-bottom: 1px dotted #ddd;
            cursor: help
        }

        abbr {
            text-transform: none
        }

        blockquote {
            margin: 0 0 1.25em;
            padding: .5625em 1.25em 0 1.1875em;
            border-left: 1px solid #ddd
        }

        blockquote cite {
            display: block;
            font-size: .9375em;
            color: rgba(0, 0, 0, .6)
        }

        blockquote cite:before {
            content: "\2014 \0020"
        }

        blockquote cite a, blockquote cite a:visited {
            color: rgba(0, 0, 0, .6)
        }

        blockquote, blockquote p {
            line-height: 1.6;
            color: rgba(0, 0, 0, .85)
        }

        @media only screen and (min-width: 768px) {
            h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 {
                line-height: 1.2
            }

            h1 {
                font-size: 2.75em
            }

            h2 {
                font-size: 2.3125em
            }

            h3, #toctitle, .sidebarblock > .content > .title {
                font-size: 1.6875em
            }

            h4 {
                font-size: 1.4375em
            }
        }

        table {
            background: #fff;
            margin-bottom: 1.25em;
            border: solid 1px #dedede
        }

        table thead, table tfoot {
            background: #f7f8f7;
            font-weight: bold
        }

        table thead tr th, table thead tr td, table tfoot tr th, table tfoot tr td {
            padding: .5em .625em .625em;
            font-size: inherit;
            color: rgba(0, 0, 0, .8);
            text-align: left
        }

        table tr th, table tr td {
            padding: .5625em .625em;
            font-size: inherit;
            color: rgba(0, 0, 0, .8)
        }

        table tr.even, table tr.alt, table tr:nth-of-type(even) {
            background: #f8f8f7
        }

        table thead tr th, table tfoot tr th, table tbody tr td, table tr td, table tfoot tr td {
            display: table-cell;
            line-height: 1.6
        }

        h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 {
            line-height: 1.2;
            word-spacing: -.05em
        }

        h1 strong, h2 strong, h3 strong, #toctitle strong, .sidebarblock > .content > .title strong, h4 strong, h5 strong, h6 strong {
            font-weight: 400
        }

        .clearfix:before, .clearfix:after, .float-group:before, .float-group:after {
            content: " ";
            display: table
        }

        .clearfix:after, .float-group:after {
            clear: both
        }

        *:not(pre) > code {
            font-size: .9375em;
            font-style: normal !important;
            letter-spacing: 0;
            padding: .1em .5ex;
            word-spacing: -.15em;
            background-color: #f7f7f8;
            -webkit-border-radius: 4px;
            border-radius: 4px;
            line-height: 1.45;
            text-rendering: optimizeSpeed;
            word-wrap: break-word
        }

        *:not(pre) > code.nobreak {
            word-wrap: normal
        }

        *:not(pre) > code.nowrap {
            white-space: nowrap
        }

        pre, pre > code {
            line-height: 1.45;
            color: rgba(0, 0, 0, .9);
            font-family: "Droid Sans Mono", "DejaVu Sans Mono", monospace;
            font-weight: 400;
            text-rendering: optimizeSpeed
        }

        em em {
            font-style: normal
        }

        strong strong {
            font-weight: 400
        }

        .keyseq {
            color: rgba(51, 51, 51, .8)
        }

        kbd {
            font-family: "Droid Sans Mono", "DejaVu Sans Mono", monospace;
            display: inline-block;
            color: rgba(0, 0, 0, .8);
            font-size: .65em;
            line-height: 1.45;
            background-color: #f7f7f7;
            border: 1px solid #ccc;
            -webkit-border-radius: 3px;
            border-radius: 3px;
            -webkit-box-shadow: 0 1px 0 rgba(0, 0, 0, .2), 0 0 0 .1em white inset;
            box-shadow: 0 1px 0 rgba(0, 0, 0, .2), 0 0 0 .1em #fff inset;
            margin: 0 .15em;
            padding: .2em .5em;
            vertical-align: middle;
            position: relative;
            top: -.1em;
            white-space: nowrap
        }

        .keyseq kbd:first-child {
            margin-left: 0
        }

        .keyseq kbd:last-child {
            margin-right: 0
        }

        .menuseq, .menuref {
            color: #000
        }

        .menuseq b:not(.caret), .menuref {
            font-weight: inherit
        }

        .menuseq {
            word-spacing: -.02em
        }

        .menuseq b.caret {
            font-size: 1.25em;
            line-height: .8
        }

        .menuseq i.caret {
            font-weight: bold;
            text-align: center;
            width: .45em
        }

        b.button:before, b.button:after {
            position: relative;
            top: -1px;
            font-weight: 400
        }

        b.button:before {
            content: "[";
            padding: 0 3px 0 2px
        }

        b.button:after {
            content: "]";
            padding: 0 2px 0 3px
        }

        p a > code:hover {
            color: rgba(0, 0, 0, .9)
        }

        #header, #content, #footnotes, #footer {
            width: 100%;
            margin-left: auto;
            margin-right: auto;
            margin-top: 0;
            margin-bottom: 0;
            max-width: 62.5em;
            *zoom: 1;
            position: relative;
            padding-left: .9375em;
            padding-right: .9375em
        }

        #header:before, #header:after, #content:before, #content:after, #footnotes:before, #footnotes:after, #footer:before, #footer:after {
            content: " ";
            display: table
        }

        #header:after, #content:after, #footnotes:after, #footer:after {
            clear: both
        }

        #content {
            margin-top: 1.25em
        }

        #content:before {
            content: none
        }

        #header > h1:first-child {
            color: rgba(0, 0, 0, .85);
            margin-top: 2.25rem;
            margin-bottom: 0
        }

        #header > h1:first-child + #toc {
            margin-top: 8px;
            border-top: 1px solid #ddddd8
        }

        #header > h1:only-child, body.toc2 #header > h1:nth-last-child(2) {
            border-bottom: 1px solid #ddddd8;
            padding-bottom: 8px
        }

        #header .details {
            border-bottom: 1px solid #ddddd8;
            line-height: 1.45;
            padding-top: .25em;
            padding-bottom: .25em;
            padding-left: .25em;
            color: rgba(0, 0, 0, .6);
            display: -ms-flexbox;
            display: -webkit-flex;
            display: flex;
            -ms-flex-flow: row wrap;
            -webkit-flex-flow: row wrap;
            flex-flow: row wrap
        }

        #header .details span:first-child {
            margin-left: -.125em
        }

        #header .details span.email a {
            color: rgba(0, 0, 0, .85)
        }

        #header .details br {
            display: none
        }

        #header .details br + span:before {
            content: "\00a0\2013\00a0"
        }

        #header .details br + span.author:before {
            content: "\00a0\22c5\00a0";
            color: rgba(0, 0, 0, .85)
        }

        #header .details br + span#revremark:before {
            content: "\00a0|\00a0"
        }

        #header #revnumber {
            text-transform: capitalize
        }

        #header #revnumber:after {
            content: "\00a0"
        }

        #content > h1:first-child:not([class]) {
            color: rgba(0, 0, 0, .85);
            border-bottom: 1px solid #ddddd8;
            padding-bottom: 8px;
            margin-top: 0;
            padding-top: 1rem;
            margin-bottom: 1.25rem
        }

        #toc {
            border-bottom: 1px solid #efefed;
            padding-bottom: .5em
        }

        #toc > ul {
            margin-left: .125em
        }

        #toc ul.sectlevel0 > li > a {
            font-style: italic
        }

        #toc ul.sectlevel0 ul.sectlevel1 {
            margin: .5em 0
        }

        #toc ul {
            font-family: "Open Sans", "DejaVu Sans", sans-serif;
            list-style-type: none
        }

        #toc li {
            line-height: 1.3334;
            margin-top: .3334em
        }

        #toc a {
            text-decoration: none
        }

        #toc a:active {
            text-decoration: underline
        }

        #toctitle {
            color: #7a2518;
            font-size: 1.2em
        }

        @media only screen and (min-width: 768px) {
            #toctitle {
                font-size: 1.375em
            }

            body.toc2 {
                padding-left: 15em;
                padding-right: 0
            }

            #toc.toc2 {
                margin-top: 0 !important;
                background-color: #f8f8f7;
                position: fixed;
                width: 15em;
                left: 0;
                top: 0;
                border-right: 1px solid #efefed;
                border-top-width: 0 !important;
                border-bottom-width: 0 !important;
                z-index: 1000;
                padding: 1.25em 1em;
                height: 100%;
                overflow: auto
            }

            #toc.toc2 #toctitle {
                margin-top: 0;
                margin-bottom: .8rem;
                font-size: 1.2em
            }

            #toc.toc2 > ul {
                font-size: .9em;
                margin-bottom: 0
            }

            #toc.toc2 ul ul {
                margin-left: 0;
                padding-left: 1em
            }

            #toc.toc2 ul.sectlevel0 ul.sectlevel1 {
                padding-left: 0;
                margin-top: .5em;
                margin-bottom: .5em
            }

            body.toc2.toc-right {
                padding-left: 0;
                padding-right: 15em
            }

            body.toc2.toc-right #toc.toc2 {
                border-right-width: 0;
                border-left: 1px solid #efefed;
                left: auto;
                right: 0
            }
        }

        @media only screen and (min-width: 1280px) {
            body.toc2 {
                padding-left: 20em;
                padding-right: 0
            }

            #toc.toc2 {
                width: 20em
            }

            #toc.toc2 #toctitle {
                font-size: 1.375em
            }

            #toc.toc2 > ul {
                font-size: .95em
            }

            #toc.toc2 ul ul {
                padding-left: 1.25em
            }

            body.toc2.toc-right {
                padding-left: 0;
                padding-right: 20em
            }
        }

        #content #toc {
            border-style: solid;
            border-width: 1px;
            border-color: #e0e0dc;
            margin-bottom: 1.25em;
            padding: 1.25em;
            background: #f8f8f7;
            -webkit-border-radius: 4px;
            border-radius: 4px
        }

        #content #toc > :first-child {
            margin-top: 0
        }

        #content #toc > :last-child {
            margin-bottom: 0
        }

        #footer {
            max-width: 100%;
            background-color: rgba(0, 0, 0, .8);
            padding: 1.25em
        }

        #footer-text {
            color: rgba(255, 255, 255, .8);
            line-height: 1.44
        }

        .sect1 {
            padding-bottom: .625em
        }

        @media only screen and (min-width: 768px) {
            .sect1 {
                padding-bottom: 1.25em
            }
        }

        .sect1 + .sect1 {
            border-top: 1px solid #efefed
        }

        #content h1 > a.anchor, h2 > a.anchor, h3 > a.anchor, #toctitle > a.anchor, .sidebarblock > .content > .title > a.anchor, h4 > a.anchor, h5 > a.anchor, h6 > a.anchor {
            position: absolute;
            z-index: 1001;
            width: 1.5ex;
            margin-left: -1.5ex;
            display: block;
            text-decoration: none !important;
            visibility: hidden;
            text-align: center;
            font-weight: 400
        }

        #content h1 > a.anchor:before, h2 > a.anchor:before, h3 > a.anchor:before, #toctitle > a.anchor:before, .sidebarblock > .content > .title > a.anchor:before, h4 > a.anchor:before, h5 > a.anchor:before, h6 > a.anchor:before {
            content: "\00A7";
            font-size: .85em;
            display: block;
            padding-top: .1em
        }

        #content h1:hover > a.anchor, #content h1 > a.anchor:hover, h2:hover > a.anchor, h2 > a.anchor:hover, h3:hover > a.anchor, #toctitle:hover > a.anchor, .sidebarblock > .content > .title:hover > a.anchor, h3 > a.anchor:hover, #toctitle > a.anchor:hover, .sidebarblock > .content > .title > a.anchor:hover, h4:hover > a.anchor, h4 > a.anchor:hover, h5:hover > a.anchor, h5 > a.anchor:hover, h6:hover > a.anchor, h6 > a.anchor:hover {
            visibility: visible
        }

        #content h1 > a.link, h2 > a.link, h3 > a.link, #toctitle > a.link, .sidebarblock > .content > .title > a.link, h4 > a.link, h5 > a.link, h6 > a.link {
            color: #ba3925;
            text-decoration: none
        }

        #content h1 > a.link:hover, h2 > a.link:hover, h3 > a.link:hover, #toctitle > a.link:hover, .sidebarblock > .content > .title > a.link:hover, h4 > a.link:hover, h5 > a.link:hover, h6 > a.link:hover {
            color: #a53221
        }

        .audioblock, .imageblock, .literalblock, .listingblock, .stemblock, .videoblock {
            margin-bottom: 1.25em
        }

        .admonitionblock td.content > .title, .audioblock > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .stemblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, table.tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title {
            text-rendering: optimizeLegibility;
            text-align: left;
            font-family: "Noto Serif", "DejaVu Serif", serif;
            font-size: 1rem;
            font-style: italic
        }

        table.tableblock > caption.title {
            white-space: nowrap;
            overflow: visible;
            max-width: 0
        }

        .paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p {
            color: rgba(0, 0, 0, .85)
        }

        table.tableblock #preamble > .sectionbody > .paragraph:first-of-type p {
            font-size: inherit
        }

        .admonitionblock > table {
            border-collapse: separate;
            border: 0;
            background: none;
            width: 100%
        }

        .admonitionblock > table td.icon {
            text-align: center;
            width: 80px
        }

        .admonitionblock > table td.icon img {
            max-width: initial
        }

        .admonitionblock > table td.icon .title {
            font-weight: bold;
            font-family: "Open Sans", "DejaVu Sans", sans-serif;
            text-transform: uppercase
        }

        .admonitionblock > table td.content {
            padding-left: 1.125em;
            padding-right: 1.25em;
            border-left: 1px solid #ddddd8;
            color: rgba(0, 0, 0, .6)
        }

        .admonitionblock > table td.content > :last-child > :last-child {
            margin-bottom: 0
        }

        .exampleblock > .content {
            border-style: solid;
            border-width: 1px;
            border-color: #e6e6e6;
            margin-bottom: 1.25em;
            padding: 1.25em;
            background: #fff;
            -webkit-border-radius: 4px;
            border-radius: 4px
        }

        .exampleblock > .content > :first-child {
            margin-top: 0
        }

        .exampleblock > .content > :last-child {
            margin-bottom: 0
        }

        .sidebarblock {
            border-style: solid;
            border-width: 1px;
            border-color: #e0e0dc;
            margin-bottom: 1.25em;
            padding: 1.25em;
            background: #f8f8f7;
            -webkit-border-radius: 4px;
            border-radius: 4px
        }

        .sidebarblock > :first-child {
            margin-top: 0
        }

        .sidebarblock > :last-child {
            margin-bottom: 0
        }

        .sidebarblock > .content > .title {
            color: #7a2518;
            margin-top: 0;
            text-align: center
        }

        .exampleblock > .content > :last-child > :last-child, .exampleblock > .content .olist > ol > li:last-child > :last-child, .exampleblock > .content .ulist > ul > li:last-child > :last-child, .exampleblock > .content .qlist > ol > li:last-child > :last-child, .sidebarblock > .content > :last-child > :last-child, .sidebarblock > .content .olist > ol > li:last-child > :last-child, .sidebarblock > .content .ulist > ul > li:last-child > :last-child, .sidebarblock > .content .qlist > ol > li:last-child > :last-child {
            margin-bottom: 0
        }

        .literalblock pre, .listingblock pre:not(.highlight), .listingblock pre[class="highlight"], .listingblock pre[class^="highlight "], .listingblock pre.CodeRay, .listingblock pre.prettyprint {
            background: #f7f7f8
        }

        .sidebarblock .literalblock pre, .sidebarblock .listingblock pre:not(.highlight), .sidebarblock .listingblock pre[class="highlight"], .sidebarblock .listingblock pre[class^="highlight "], .sidebarblock .listingblock pre.CodeRay, .sidebarblock .listingblock pre.prettyprint {
            background: #f2f1f1
        }

        .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] {
            -webkit-border-radius: 4px;
            border-radius: 4px;
            word-wrap: break-word;
            padding: 1em;
            font-size: .8125em
        }

        .literalblock pre.nowrap, .literalblock pre[class].nowrap, .listingblock pre.nowrap, .listingblock pre[class].nowrap {
            overflow-x: auto;
            white-space: pre;
            word-wrap: normal
        }

        @media only screen and (min-width: 768px) {
            .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] {
                font-size: .90625em
            }
        }

        @media only screen and (min-width: 1280px) {
            .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] {
                font-size: 1em
            }
        }

        .literalblock.output pre {
            color: #f7f7f8;
            background-color: rgba(0, 0, 0, .9)
        }

        .listingblock pre.highlightjs {
            padding: 0
        }

        .listingblock pre.highlightjs > code {
            padding: 1em;
            -webkit-border-radius: 4px;
            border-radius: 4px
        }

        .listingblock pre.prettyprint {
            border-width: 0
        }

        .listingblock > .content {
            position: relative
        }

        .listingblock code[data-lang]:before {
            display: none;
            content: attr(data-lang);
            position: absolute;
            font-size: .75em;
            top: .425rem;
            right: .5rem;
            line-height: 1;
            text-transform: uppercase;
            color: #999
        }

        .listingblock:hover code[data-lang]:before {
            display: block
        }

        .listingblock.terminal pre .command:before {
            content: attr(data-prompt);
            padding-right: .5em;
            color: #999
        }

        .listingblock.terminal pre .command:not([data-prompt]):before {
            content: "$"
        }

        table.pyhltable {
            border-collapse: separate;
            border: 0;
            margin-bottom: 0;
            background: none
        }

        table.pyhltable td {
            vertical-align: top;
            padding-top: 0;
            padding-bottom: 0;
            line-height: 1.45
        }

        table.pyhltable td.code {
            padding-left: .75em;
            padding-right: 0
        }

        pre.pygments .lineno, table.pyhltable td:not(.code) {
            color: #999;
            padding-left: 0;
            padding-right: .5em;
            border-right: 1px solid #ddddd8
        }

        pre.pygments .lineno {
            display: inline-block;
            margin-right: .25em
        }

        table.pyhltable .linenodiv {
            background: none !important;
            padding-right: 0 !important
        }

        .quoteblock {
            margin: 0 1em 1.25em 1.5em;
            display: table
        }

        .quoteblock > .title {
            margin-left: -1.5em;
            margin-bottom: .75em
        }

        .quoteblock blockquote, .quoteblock blockquote p {
            color: rgba(0, 0, 0, .85);
            font-size: 1.15rem;
            line-height: 1.75;
            word-spacing: .1em;
            letter-spacing: 0;
            font-style: italic;
            text-align: justify
        }

        .quoteblock blockquote {
            margin: 0;
            padding: 0;
            border: 0
        }

        .quoteblock blockquote:before {
            content: "\201c";
            float: left;
            font-size: 2.75em;
            font-weight: bold;
            line-height: .6em;
            margin-left: -.6em;
            color: #7a2518;
            text-shadow: 0 1px 2px rgba(0, 0, 0, .1)
        }

        .quoteblock blockquote > .paragraph:last-child p {
            margin-bottom: 0
        }

        .quoteblock .attribution {
            margin-top: .5em;
            margin-right: .5ex;
            text-align: right
        }

        .quoteblock .quoteblock {
            margin-left: 0;
            margin-right: 0;
            padding: .5em 0;
            border-left: 3px solid rgba(0, 0, 0, .6)
        }

        .quoteblock .quoteblock blockquote {
            padding: 0 0 0 .75em
        }

        .quoteblock .quoteblock blockquote:before {
            display: none
        }

        .verseblock {
            margin: 0 1em 1.25em 1em
        }

        .verseblock pre {
            font-family: "Open Sans", "DejaVu Sans", sans;
            font-size: 1.15rem;
            color: rgba(0, 0, 0, .85);
            font-weight: 300;
            text-rendering: optimizeLegibility
        }

        .verseblock pre strong {
            font-weight: 400
        }

        .verseblock .attribution {
            margin-top: 1.25rem;
            margin-left: .5ex
        }

        .quoteblock .attribution, .verseblock .attribution {
            font-size: .9375em;
            line-height: 1.45;
            font-style: italic
        }

        .quoteblock .attribution br, .verseblock .attribution br {
            display: none
        }

        .quoteblock .attribution cite, .verseblock .attribution cite {
            display: block;
            letter-spacing: -.025em;
            color: rgba(0, 0, 0, .6)
        }

        .quoteblock.abstract {
            margin: 0 0 1.25em 0;
            display: block
        }

        .quoteblock.abstract blockquote, .quoteblock.abstract blockquote p {
            text-align: left;
            word-spacing: 0
        }

        .quoteblock.abstract blockquote:before, .quoteblock.abstract blockquote p:first-of-type:before {
            display: none
        }

        table.tableblock {
            max-width: 100%;
            border-collapse: separate
        }

        table.tableblock td > .paragraph:last-child p > p:last-child, table.tableblock th > p:last-child, table.tableblock td > p:last-child {
            margin-bottom: 0
        }

        table.tableblock, th.tableblock, td.tableblock {
            border: 0 solid #dedede
        }

        table.grid-all > thead > tr > .tableblock, table.grid-all > tbody > tr > .tableblock {
            border-width: 0 1px 1px 0
        }

        table.grid-all > tfoot > tr > .tableblock {
            border-width: 1px 1px 0 0
        }

        table.grid-cols > * > tr > .tableblock {
            border-width: 0 1px 0 0
        }

        table.grid-rows > thead > tr > .tableblock, table.grid-rows > tbody > tr > .tableblock {
            border-width: 0 0 1px 0
        }

        table.grid-rows > tfoot > tr > .tableblock {
            border-width: 1px 0 0 0
        }

        table.grid-all > * > tr > .tableblock:last-child, table.grid-cols > * > tr > .tableblock:last-child {
            border-right-width: 0
        }

        table.grid-all > tbody > tr:last-child > .tableblock, table.grid-all > thead:last-child > tr > .tableblock, table.grid-rows > tbody > tr:last-child > .tableblock, table.grid-rows > thead:last-child > tr > .tableblock {
            border-bottom-width: 0
        }

        table.frame-all {
            border-width: 1px
        }

        table.frame-sides {
            border-width: 0 1px
        }

        table.frame-topbot {
            border-width: 1px 0
        }

        th.halign-left, td.halign-left {
            text-align: left
        }

        th.halign-right, td.halign-right {
            text-align: right
        }

        th.halign-center, td.halign-center {
            text-align: center
        }

        th.valign-top, td.valign-top {
            vertical-align: top
        }

        th.valign-bottom, td.valign-bottom {
            vertical-align: bottom
        }

        th.valign-middle, td.valign-middle {
            vertical-align: middle
        }

        table thead th, table tfoot th {
            font-weight: bold
        }

        tbody tr th {
            display: table-cell;
            line-height: 1.6;
            background: #f7f8f7
        }

        tbody tr th, tbody tr th p, tfoot tr th, tfoot tr th p {
            color: rgba(0, 0, 0, .8);
            font-weight: bold
        }

        p.tableblock > code:only-child {
            background: none;
            padding: 0
        }

        p.tableblock {
            font-size: 1em
        }

        td > div.verse {
            white-space: pre
        }

        ol {
            margin-left: 1.75em
        }

        ul li ol {
            margin-left: 1.5em
        }

        dl dd {
            margin-left: 1.125em
        }

        dl dd:last-child, dl dd:last-child > :last-child {
            margin-bottom: 0
        }

        ol > li p, ul > li p, ul dd, ol dd, .olist .olist, .ulist .ulist, .ulist .olist, .olist .ulist {
            margin-bottom: .625em
        }

        ul.checklist, ul.none, ol.none, ul.no-bullet, ol.no-bullet, ol.unnumbered, ul.unstyled, ol.unstyled {
            list-style-type: none
        }

        ul.no-bullet, ol.no-bullet, ol.unnumbered {
            margin-left: .625em
        }

        ul.unstyled, ol.unstyled {
            margin-left: 0
        }

        ul.checklist {
            margin-left: .625em
        }

        ul.checklist li > p:first-child > .fa-square-o:first-child, ul.checklist li > p:first-child > .fa-check-square-o:first-child {
            width: 1.25em;
            font-size: .8em;
            position: relative;
            bottom: .125em
        }

        ul.checklist li > p:first-child > input[type="checkbox"]:first-child {
            margin-right: .25em
        }

        ul.inline {
            margin: 0 auto .625em auto;
            margin-left: -1.375em;
            margin-right: 0;
            padding: 0;
            list-style: none;
            overflow: hidden
        }

        ul.inline > li {
            list-style: none;
            float: left;
            margin-left: 1.375em;
            display: block
        }

        ul.inline > li > * {
            display: block
        }

        .unstyled dl dt {
            font-weight: 400;
            font-style: normal
        }

        ol.arabic {
            list-style-type: decimal
        }

        ol.decimal {
            list-style-type: decimal-leading-zero
        }

        ol.loweralpha {
            list-style-type: lower-alpha
        }

        ol.upperalpha {
            list-style-type: upper-alpha
        }

        ol.lowerroman {
            list-style-type: lower-roman
        }

        ol.upperroman {
            list-style-type: upper-roman
        }

        ol.lowergreek {
            list-style-type: lower-greek
        }

        .hdlist > table, .colist > table {
            border: 0;
            background: none
        }

        .hdlist > table > tbody > tr, .colist > table > tbody > tr {
            background: none
        }

        td.hdlist1, td.hdlist2 {
            vertical-align: top;
            padding: 0 .625em
        }

        td.hdlist1 {
            font-weight: bold;
            padding-bottom: 1.25em
        }

        .literalblock + .colist, .listingblock + .colist {
            margin-top: -.5em
        }

        .colist > table tr > td:first-of-type {
            padding: .4em .75em 0 .75em;
            line-height: 1;
            vertical-align: top
        }

        .colist > table tr > td:first-of-type img {
            max-width: initial
        }

        .colist > table tr > td:last-of-type {
            padding: .25em 0
        }

        .thumb, .th {
            line-height: 0;
            display: inline-block;
            border: solid 4px #fff;
            -webkit-box-shadow: 0 0 0 1px #ddd;
            box-shadow: 0 0 0 1px #ddd
        }

        .imageblock.left, .imageblock[style*="float: left"] {
            margin: .25em .625em 1.25em 0
        }

        .imageblock.right, .imageblock[style*="float: right"] {
            margin: .25em 0 1.25em .625em
        }

        .imageblock > .title {
            margin-bottom: 0
        }

        .imageblock.thumb, .imageblock.th {
            border-width: 6px
        }

        .imageblock.thumb > .title, .imageblock.th > .title {
            padding: 0 .125em
        }

        .image.left, .image.right {
            margin-top: .25em;
            margin-bottom: .25em;
            display: inline-block;
            line-height: 0
        }

        .image.left {
            margin-right: .625em
        }

        .image.right {
            margin-left: .625em
        }

        a.image {
            text-decoration: none;
            display: inline-block
        }

        a.image object {
            pointer-events: none
        }

        sup.footnote, sup.footnoteref {
            font-size: .875em;
            position: static;
            vertical-align: super
        }

        sup.footnote a, sup.footnoteref a {
            text-decoration: none
        }

        sup.footnote a:active, sup.footnoteref a:active {
            text-decoration: underline
        }

        #footnotes {
            padding-top: .75em;
            padding-bottom: .75em;
            margin-bottom: .625em
        }

        #footnotes hr {
            width: 20%;
            min-width: 6.25em;
            margin: -.25em 0 .75em 0;
            border-width: 1px 0 0 0
        }

        #footnotes .footnote {
            padding: 0 .375em 0 .225em;
            line-height: 1.3334;
            font-size: .875em;
            margin-left: 1.2em;
            text-indent: -1.05em;
            margin-bottom: .2em
        }

        #footnotes .footnote a:first-of-type {
            font-weight: bold;
            text-decoration: none
        }

        #footnotes .footnote:last-of-type {
            margin-bottom: 0
        }

        #content #footnotes {
            margin-top: -.625em;
            margin-bottom: 0;
            padding: .75em 0
        }

        .gist .file-data > table {
            border: 0;
            background: #fff;
            width: 100%;
            margin-bottom: 0
        }

        .gist .file-data > table td.line-data {
            width: 99%
        }

        div.unbreakable {
            page-break-inside: avoid
        }

        .big {
            font-size: larger
        }

        .small {
            font-size: smaller
        }

        .underline {
            text-decoration: underline
        }

        .overline {
            text-decoration: overline
        }

        .line-through {
            text-decoration: line-through
        }

        .aqua {
            color: #00bfbf
        }

        .aqua-background {
            background-color: #00fafa
        }

        .black {
            color: #000
        }

        .black-background {
            background-color: #000
        }

        .blue {
            color: #0000bf
        }

        .blue-background {
            background-color: #0000fa
        }

        .fuchsia {
            color: #bf00bf
        }

        .fuchsia-background {
            background-color: #fa00fa
        }

        .gray {
            color: #606060
        }

        .gray-background {
            background-color: #7d7d7d
        }

        .green {
            color: #006000
        }

        .green-background {
            background-color: #007d00
        }

        .lime {
            color: #00bf00
        }

        .lime-background {
            background-color: #00fa00
        }

        .maroon {
            color: #600000
        }

        .maroon-background {
            background-color: #7d0000
        }

        .navy {
            color: #000060
        }

        .navy-background {
            background-color: #00007d
        }

        .olive {
            color: #606000
        }

        .olive-background {
            background-color: #7d7d00
        }

        .purple {
            color: #600060
        }

        .purple-background {
            background-color: #7d007d
        }

        .red {
            color: #bf0000
        }

        .red-background {
            background-color: #fa0000
        }

        .silver {
            color: #909090
        }

        .silver-background {
            background-color: #bcbcbc
        }

        .teal {
            color: #006060
        }

        .teal-background {
            background-color: #007d7d
        }

        .white {
            color: #bfbfbf
        }

        .white-background {
            background-color: #fafafa
        }

        .yellow {
            color: #bfbf00
        }

        .yellow-background {
            background-color: #fafa00
        }

        span.icon > .fa {
            cursor: default
        }

        a span.icon > .fa {
            cursor: inherit
        }

        .admonitionblock td.icon [class^="fa icon-"] {
            font-size: 2.5em;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, .5);
            cursor: default
        }

        .admonitionblock td.icon .icon-note:before {
            content: "\f05a";
            color: #19407c
        }

        .admonitionblock td.icon .icon-tip:before {
            content: "\f0eb";
            text-shadow: 1px 1px 2px rgba(155, 155, 0, .8);
            color: #111
        }

        .admonitionblock td.icon .icon-warning:before {
            content: "\f071";
            color: #bf6900
        }

        .admonitionblock td.icon .icon-caution:before {
            content: "\f06d";
            color: #bf3400
        }

        .admonitionblock td.icon .icon-important:before {
            content: "\f06a";
            color: #bf0000
        }

        .conum[data-value] {
            display: inline-block;
            color: #fff !important;
            background-color: rgba(0, 0, 0, .8);
            -webkit-border-radius: 100px;
            border-radius: 100px;
            text-align: center;
            font-size: .75em;
            width: 1.67em;
            height: 1.67em;
            line-height: 1.67em;
            font-family: "Open Sans", "DejaVu Sans", sans-serif;
            font-style: normal;
            font-weight: bold
        }

        .conum[data-value] * {
            color: #fff !important
        }

        .conum[data-value] + b {
            display: none
        }

        .conum[data-value]:after {
            content: attr(data-value)
        }

        pre .conum[data-value] {
            position: relative;
            top: -.125em
        }

        b.conum * {
            color: inherit !important
        }

        .conum:not([data-value]):empty {
            display: none
        }

        dt, th.tableblock, td.content, div.footnote {
            text-rendering: optimizeLegibility
        }

        h1, h2, p, td.content, span.alt {
            letter-spacing: -.01em
        }

        p strong, td.content strong, div.footnote strong {
            letter-spacing: -.005em
        }

        p, blockquote, dt, td.content, span.alt {
            font-size: 1.0625rem
        }

        p {
            margin-bottom: 1.25rem
        }

        .sidebarblock p, .sidebarblock dt, .sidebarblock td.content, p.tableblock {
            font-size: 1em
        }

        .exampleblock > .content {
            background-color: #fffef7;
            border-color: #e0e0dc;
            -webkit-box-shadow: 0 1px 4px #e0e0dc;
            box-shadow: 0 1px 4px #e0e0dc
        }

        .print-only {
            display: none !important
        }

        @media print {
            @page {
                margin: 1.25cm .75cm
            }

            * {
                -webkit-box-shadow: none !important;
                box-shadow: none !important;
                text-shadow: none !important
            }

            a {
                color: inherit !important;
                text-decoration: underline !important
            }

            a.bare, a[href^="#"], a[href^="mailto:"] {
                text-decoration: none !important
            }

            a[href^="http:"]:not(.bare):after, a[href^="https:"]:not(.bare):after {
                content: "(" attr(href) ")";
                display: inline-block;
                font-size: .875em;
                padding-left: .25em
            }

            abbr[title]:after {
                content: " (" attr(title) ")"
            }

            pre, blockquote, tr, img, object, svg {
                page-break-inside: avoid
            }

            thead {
                display: table-header-group
            }

            svg {
                max-width: 100%
            }

            p, blockquote, dt, td.content {
                font-size: 1em;
                orphans: 3;
                widows: 3
            }

            h2, h3, #toctitle, .sidebarblock > .content > .title {
                page-break-after: avoid
            }

            #toc, .sidebarblock, .exampleblock > .content {
                background: none !important
            }

            #toc {
                border-bottom: 1px solid #ddddd8 !important;
                padding-bottom: 0 !important
            }

            .sect1 {
                padding-bottom: 0 !important
            }

            .sect1 + .sect1 {
                border: 0 !important
            }

            #header > h1:first-child {
                margin-top: 1.25rem
            }

            body.book #header {
                text-align: center
            }

            body.book #header > h1:first-child {
                border: 0 !important;
                margin: 2.5em 0 1em 0
            }

            body.book #header .details {
                border: 0 !important;
                display: block;
                padding: 0 !important
            }

            body.book #header .details span:first-child {
                margin-left: 0 !important
            }

            body.book #header .details br {
                display: block
            }

            body.book #header .details br + span:before {
                content: none !important
            }

            body.book #toc {
                border: 0 !important;
                text-align: left !important;
                padding: 0 !important;
                margin: 0 !important
            }

            body.book #toc, body.book #preamble, body.book h1.sect0, body.book .sect1 > h2 {
                page-break-before: always
            }

            .listingblock code[data-lang]:before {
                display: block
            }

            #footer {
                background: none !important;
                padding: 0 .9375em
            }

            #footer-text {
                color: rgba(0, 0, 0, .6) !important;
                font-size: .9em
            }

            .hide-on-print {
                display: none !important
            }

            .print-only {
                display: block !important
            }

            .hide-for-print {
                display: none !important
            }

            .show-for-print {
                display: inherit !important
            }
        }
    </style>
    <!-- Generate a nice dynamic TOC using Tocbot -->

    <!-- tocbot.css inlined and compressed-->
    <style>
        .js-toc {
            display: inline-flex;
        }

        .toc {
            overflow-y: auto
        }

        .toc > ul {
            overflow: hidden;
            position: relative
        }

        .toc > ul li {
            list-style: none
        }

        .toc-list {
            margin: 0;
            padding-left: 10px
        }

        a.toc-link {
            color: #2156a5;
            height: 100%
        }

        .node-name--H1 {
            font-size: 1.2em;
            font-weight: 900;
        }

        .node-name--H2 {
            font-size: 0.9em;
            font-weight: 600;
        }

        .node-name--H3 {
            font-size: 0.8em;
        }

        .node-name--H4 {
            font-size: 0.6em;
        }

        .node-name--H5 {
            font-size: 0.6em;
        }

        .node-name--H6 {
            font-size: 0.6em;
        }

        .is-collapsible {
            max-height: 3000px;
            overflow: hidden;
            transition: all 0ms ease-in-out
        }

        .is-collapsed {
            max-height: 0
        }

        .is-position-fixed {
            position: fixed !important;
            top: 0
        }

        .is-active-link {
            font-weight: 600;
        }

        .toc-link::before {
            content: ' ';
            display: inline-flex;
            height: auto;
            left: 0;
            margin-top: -1px;
            position: absolute;
            width: 2px
        }
    </style>

    <!-- tocbot.min.js inlined -->
    <script type="text/javascript">
      !function (e) {
        function t(o) {
          if (n[o]) return n[o].exports;
          var i = n[o] = {i: o, l: !1, exports: {}};
          return e[o].call(i.exports, i, i.exports, t), i.l = !0, i.exports
        }

        var n = {};
        t.m = e, t.c = n, t.i = function (e) {
          return e
        }, t.d = function (e, n, o) {
          t.o(e, n) || Object.defineProperty(e, n, {configurable: !1, enumerable: !0, get: o})
        }, t.n = function (e) {
          var n = e && e.__esModule ? function () {
            return e.default
          } : function () {
            return e
          };
          return t.d(n, "a", n), n
        }, t.o = function (e, t) {
          return Object.prototype.hasOwnProperty.call(e, t)
        }, t.p = "", t(t.s = 5)
      }([function (e, t) {
        var n;
        n = function () {
          return this
        }();
        try {
          n = n || Function("return this")() || (0, eval)("this")
        } catch (e) {
          "object" == typeof window && (n = window)
        }
        e.exports = n
      }, function (e, t, n) {
        var o, i, r;
        !function (n, l) {
          i = [], o = l(), void 0 !== (r = "function" == typeof o ? o.apply(t, i) : o) && (e.exports = r)
        }(0, function () {
          "use strict";
          var e = function (e) {
            return "getComputedStyle" in window && "smooth" === window.getComputedStyle(e)["scroll-behavior"]
          };
          if ("undefined" == typeof window || !("document" in window)) return {};
          var t = function (t, n, o) {
            n = n || 999, o || 0 === o || (o = 9);
            var i, r = function (e) {
              i = e
            }, l = function () {
              clearTimeout(i), r(0)
            }, s = function (e) {
              return Math.max(0, t.getTopOf(e) - o)
            }, c = function (o, i, s) {
              if (l(), 0 === i || i && i < 0 || e(t.body)) t.toY(o), s && s(); else {
                var c = t.getY(), a = Math.max(0, o) - c, u = (new Date).getTime();
                i = i || Math.min(Math.abs(a), n), function e() {
                  r(setTimeout(function () {
                    var n = Math.min(1, ((new Date).getTime() - u) / i),
                      o = Math.max(0, Math.floor(c + a * (n < .5 ? 2 * n * n : n * (4 - 2 * n) - 1)));
                    t.toY(o), n < 1 && t.getHeight() + o < t.body.scrollHeight ? e() : (setTimeout(l, 99), s && s())
                  }, 9))
                }()
              }
            }, a = function (e, t, n) {
              c(s(e), t, n)
            }, u = function (e, n, i) {
              var r = e.getBoundingClientRect().height, l = t.getTopOf(e) + r, u = t.getHeight(), d = t.getY(),
                f = d + u;
              s(e) < d || r + o > u ? a(e, n, i) : l + o > f ? c(l - u + o, n, i) : i && i()
            }, d = function (e, n, o, i) {
              c(Math.max(0, t.getTopOf(e) - t.getHeight() / 2 + (o || e.getBoundingClientRect().height / 2)), n, i)
            };
            return {
              setup: function (e, t) {
                return (0 === e || e) && (n = e), (0 === t || t) && (o = t), {defaultDuration: n, edgeOffset: o}
              }, to: a, toY: c, intoView: u, center: d, stop: l, moving: function () {
                return !!i
              }, getY: t.getY, getTopOf: t.getTopOf
            }
          }, n = document.documentElement, o = function () {
            return window.scrollY || n.scrollTop
          }, i = t({
            body: document.scrollingElement || document.body, toY: function (e) {
              window.scrollTo(0, e)
            }, getY: o, getHeight: function () {
              return window.innerHeight || n.clientHeight
            }, getTopOf: function (e) {
              return e.getBoundingClientRect().top + o() - n.offsetTop
            }
          });
          if (i.createScroller = function (e, o, i) {
            return t({
              body: e, toY: function (t) {
                e.scrollTop = t
              }, getY: function () {
                return e.scrollTop
              }, getHeight: function () {
                return Math.min(e.clientHeight, window.innerHeight || n.clientHeight)
              }, getTopOf: function (e) {
                return e.offsetTop
              }
            }, o, i)
          }, "addEventListener" in window && !window.noZensmooth && !e(document.body)) {
            var r = "scrollRestoration" in history;
            r && (history.scrollRestoration = "auto"), window.addEventListener("load", function () {
              r && (setTimeout(function () {
                history.scrollRestoration = "manual"
              }, 9), window.addEventListener("popstate", function (e) {
                e.state && "zenscrollY" in e.state && i.toY(e.state.zenscrollY)
              }, !1)), window.location.hash && setTimeout(function () {
                var e = i.setup().edgeOffset;
                if (e) {
                  var t = document.getElementById(window.location.href.split("#")[1]);
                  if (t) {
                    var n = Math.max(0, i.getTopOf(t) - e), o = i.getY() - n;
                    0 <= o && o < 9 && window.scrollTo(0, n)
                  }
                }
              }, 9)
            }, !1);
            var l = new RegExp("(^|\\s)noZensmooth(\\s|$)");
            window.addEventListener("click", function (e) {
              for (var t = e.target; t && "A" !== t.tagName;) t = t.parentNode;
              if (!(!t || 1 !== e.which || e.shiftKey || e.metaKey || e.ctrlKey || e.altKey)) {
                if (r) try {
                  history.replaceState({zenscrollY: i.getY()}, "")
                } catch (e) {
                }
                var n = t.getAttribute("href") || "";
                if (0 === n.indexOf("#") && !l.test(t.className)) {
                  var o = 0, s = document.getElementById(n.substring(1));
                  if ("#" !== n) {
                    if (!s) return;
                    o = i.getTopOf(s)
                  }
                  e.preventDefault();
                  var c = function () {
                    window.location = n
                  }, a = i.setup().edgeOffset;
                  a && (o = Math.max(0, o - a), c = function () {
                    history.pushState(null, "", n)
                  }), i.toY(o, null, c)
                }
              }
            }, !1)
          }
          return i
        })
      }, function (e, t) {
        e.exports = function (e) {
          function t(e, n) {
            var r = n.appendChild(o(e));
            if (e.children.length) {
              var l = i(e.isCollapsed);
              e.children.forEach(function (e) {
                t(e, l)
              }), r.appendChild(l)
            }
          }

          function n(e, n) {
            var o = i(!1);
            n.forEach(function (e) {
              t(e, o)
            });
            var r = document.querySelector(e);
            if (null !== r) return r.firstChild && r.removeChild(r.firstChild), r.appendChild(o)
          }

          function o(t) {
            var n = document.createElement("li"), o = document.createElement("a");
            return e.listItemClass && n.setAttribute("class", e.listItemClass), e.includeHtml && t.childNodes.length ? u.call(t.childNodes, function (e) {
              o.appendChild(e.cloneNode(!0))
            }) : o.textContent = t.textContent, o.setAttribute("href", "#" + t.id), o.setAttribute("class", e.linkClass + p + "node-name--" + t.nodeName + p + e.extraLinkClasses), n.appendChild(o), n
          }

          function i(t) {
            var n = document.createElement("ul"), o = e.listClass + p + e.extraListClasses;
            return t && (o += p + e.collapsibleClass, o += p + e.isCollapsedClass), n.setAttribute("class", o), n
          }

          function r() {
            var t = document.documentElement.scrollTop || f.scrollTop,
              n = document.querySelector(e.positionFixedSelector);
            "auto" === e.fixedSidebarOffset && (e.fixedSidebarOffset = document.querySelector(e.tocSelector).offsetTop), t > e.fixedSidebarOffset ? -1 === n.className.indexOf(e.positionFixedClass) && (n.className += p + e.positionFixedClass) : n.className = n.className.split(p + e.positionFixedClass).join("")
          }

          function l(t) {
            var n = document.documentElement.scrollTop || f.scrollTop;
            e.positionFixedSelector && r();
            var o, i = t;
            if (m && null !== document.querySelector(e.tocSelector) && i.length > 0) {
              d.call(i, function (t, r) {
                if (t.offsetTop > n + e.headingsOffset + 10) {
                  return o = i[0 === r ? r : r - 1], !0
                }
                if (r === i.length - 1) return o = i[i.length - 1], !0
              });
              var l = document.querySelector(e.tocSelector).querySelectorAll("." + e.linkClass);
              u.call(l, function (t) {
                t.className = t.className.split(p + e.activeLinkClass).join("")
              });
              var c = document.querySelector(e.tocSelector).querySelector("." + e.linkClass + ".node-name--" + o.nodeName + '[href="#' + o.id + '"]');
              c.className += p + e.activeLinkClass;
              var a = document.querySelector(e.tocSelector).querySelectorAll("." + e.listClass + "." + e.collapsibleClass);
              u.call(a, function (t) {
                var n = p + e.isCollapsedClass;
                -1 === t.className.indexOf(n) && (t.className += p + e.isCollapsedClass)
              }), c.nextSibling && (c.nextSibling.className = c.nextSibling.className.split(p + e.isCollapsedClass).join("")), s(c.parentNode.parentNode)
            }
          }

          function s(t) {
            return -1 !== t.className.indexOf(e.collapsibleClass) ? (t.className = t.className.split(p + e.isCollapsedClass).join(""), s(t.parentNode.parentNode)) : t
          }

          function c(t) {
            var n = t.target || t.srcElement;
            "string" == typeof n.className && -1 !== n.className.indexOf(e.linkClass) && (m = !1)
          }

          function a() {
            m = !0
          }

          var u = [].forEach, d = [].some, f = document.body, m = !0, p = " ";
          return {enableTocAnimation: a, disableTocAnimation: c, render: n, updateToc: l}
        }
      }, function (e, t) {
        e.exports = {
          tocSelector: ".js-toc",
          contentSelector: ".js-toc-content",
          headingSelector: "h1, h2, h3",
          ignoreSelector: ".js-toc-ignore",
          linkClass: "toc-link",
          extraLinkClasses: "",
          activeLinkClass: "is-active-link",
          listClass: "toc-list",
          extraListClasses: "",
          isCollapsedClass: "is-collapsed",
          collapsibleClass: "is-collapsible",
          listItemClass: "toc-list-item",
          collapseDepth: 0,
          smoothScroll: !0,
          smoothScrollDuration: 420,
          scrollEndCallback: function (e) {
          },
          headingsOffset: 0,
          throttleTimeout: 50,
          positionFixedSelector: null,
          positionFixedClass: "is-position-fixed",
          fixedSidebarOffset: "auto",
          includeHtml: !1
        }
      }, function (e, t) {
        e.exports = function (e) {
          function t(e) {
            return e[e.length - 1]
          }

          function n(e) {
            return +e.nodeName.split("H").join("")
          }

          function o(t) {
            var o = {
              id: t.id,
              children: [],
              nodeName: t.nodeName,
              headingLevel: n(t),
              textContent: t.textContent.trim()
            };
            return e.includeHtml && (o.childNodes = t.childNodes), o
          }

          function i(i, r) {
            for (var l = o(i), s = n(i), c = r, a = t(c), u = a ? a.headingLevel : 0, d = s - u; d > 0;) a = t(c), a && void 0 !== a.children && (c = a.children), d--;
            return s >= e.collapseDepth && (l.isCollapsed = !0), c.push(l), c
          }

          function r(t, n) {
            var o = n;
            e.ignoreSelector && (o = n.split(",").map(function (t) {
              return t.trim() + ":not(" + e.ignoreSelector + ")"
            }));
            try {
              return document.querySelector(t).querySelectorAll(o)
            } catch (e) {
              return console.warn("Element not found: " + t), null
            }
          }

          function l(e) {
            return s.call(e, function (e, t) {
              return i(o(t), e.nest), e
            }, {nest: []})
          }

          var s = [].reduce;
          return {nestHeadingsArray: l, selectHeadings: r}
        }
      }, function (e, t, n) {
        (function (o) {
          var i, r, l;
          !function (n, o) {
            r = [], i = o(n), void 0 !== (l = "function" == typeof i ? i.apply(t, r) : i) && (e.exports = l)
          }(void 0 !== o ? o : this.window || this.global, function (e) {
            "use strict";

            function t() {
              for (var e = {}, t = 0; t < arguments.length; t++) {
                var n = arguments[t];
                for (var o in n) m.call(n, o) && (e[o] = n[o])
              }
              return e
            }

            function o(e, t, n) {
              t || (t = 250);
              var o, i;
              return function () {
                var r = n || this, l = +new Date, s = arguments;
                o && l < o + t ? (clearTimeout(i), i = setTimeout(function () {
                  o = l, e.apply(r, s)
                }, t)) : (o = l, e.apply(r, s))
              }
            }

            var i, r, l = n(3), s = {}, c = {}, a = n(2), u = n(4);
            if ("undefined" != typeof window) {
              var d, f = !!e.document.querySelector && !!e.addEventListener, m = Object.prototype.hasOwnProperty;
              return c.destroy = function () {
                try {
                  document.querySelector(s.tocSelector).innerHTML = ""
                } catch (e) {
                  console.warn("Element not found: " + s.tocSelector)
                }
                document.removeEventListener("scroll", this._scrollListener, !1), document.removeEventListener("resize", this._scrollListener, !1), i && document.removeEventListener("click", this._clickListener, !1)
              }, c.init = function (e) {
                if (f && (s = t(l, e || {}), this.options = s, this.state = {}, s.smoothScroll && (c.zenscroll = n(1), c.zenscroll.setup(s.smoothScrollDuration)), i = a(s), r = u(s), this._buildHtml = i, this._parseContent = r, c.destroy(), null !== (d = r.selectHeadings(s.contentSelector, s.headingSelector)))) {
                  var m = r.nestHeadingsArray(d), p = m.nest;
                  return i.render(s.tocSelector, p), this._scrollListener = o(function (e) {
                    i.updateToc(d);
                    var t = e && e.target && e.target.scrollingElement && 0 === e.target.scrollingElement.scrollTop;
                    (e && 0 === e.eventPhase || t) && (i.enableTocAnimation(), i.updateToc(d), s.scrollEndCallback && s.scrollEndCallback(e))
                  }, s.throttleTimeout), this._scrollListener(), document.addEventListener("scroll", this._scrollListener, !1), document.addEventListener("resize", this._scrollListener, !1), this._clickListener = o(function (e) {
                    s.smoothScroll && i.disableTocAnimation(e), i.updateToc(d)
                  }, s.throttleTimeout), document.addEventListener("click", this._clickListener, !1), this
                }
              }, c.refresh = function (e) {
                c.destroy(), c.init(e || this.options)
              }, e.tocbot = c, c
            }
          })
        }).call(t, n(0))
      }]);
    </script>

    <!-- Code to render TOC with collapsible/expandable elements using Tocbot -->
    <script type="text/javascript">

      document.addEventListener('DOMContentLoaded', function () {
        /* Tocbot dynamic TOC, works with tocbot 3.0.2 */
        var oldtoc = document.getElementById('toctitle').nextElementSibling;
        var newtoc = document.createElement('div');
        newtoc.setAttribute('id', 'tocbot');
        newtoc.setAttribute('class', 'js-toc');
        oldtoc.parentNode.replaceChild(newtoc, oldtoc);
        tocbot.init({
          contentSelector: '#content',
          headingSelector: 'h1, h2, h3, h4',
          smoothScroll: true
        });
        var handleTocOnResize = function () {
          var width = window.innerWidth
            || document.documentElement.clientWidth
            || document.body.clientWidth;
          if (width < 768) {
            tocbot.refresh({
              contentSelector: '#content',
              headingSelector: 'h1, h2, h3, h4',
              collapseDepth: 6,
              activeLinkClass: 'ignoreactive',
              throttleTimeout: 1000,
              smoothScroll: true
            });
          } else {
            tocbot.refresh({
              contentSelector: '#content',
              headingSelector: 'h1, h2, h3, h4',
              smoothScroll: true
            });
          }
        };
        window.addEventListener('resize', handleTocOnResize);
        handleTocOnResize();
      }, false);
    </script>
</head>
<body class="book toc2 toc-left">
<div id="header">
    <h1>Systemdokumentasjon: Foreldrepenger</h1>
    <div class="details">
        <span id="revnumber">version 1.0-SNAPSHOT,</span>
        <span id="revdate">2018-11-26T10:13:44Z</span>
    </div>
    <div class="toc2" id="toc">
        <div id="toctitle">Table of Contents</div>
        <ul class="sectlevel0">
            <li><a href="#_intro">Intro</a>
                <ul class="sectlevel1">
                    <li><a href="#_format">1. Format</a></li>
                    <li><a href="#_toolchain">2. Toolchain</a></li>
                </ul>
            </li>
            <li><a href="#_applikasjon">Applikasjon</a>
                <ul class="sectlevel1">
                    <li><a href="#_applikasjonsarkitektur">3. Applikasjonsarkitektur</a></li>
                    <li><a href="#_integrasjon">4. Integrasjon</a>
                        <ul class="sectlevel2">
                            <li><a href="#_patterns">4.1. Patterns</a>
                                <ul class="sectlevel3">
                                    <li><a href="#_fire_and_forget">4.1.1. fire and forget</a></li>
                                    <li><a href="#_asynk_request_response">4.1.2. asynk request/response</a></li>
                                    <li><a href="#_synk_request_response">4.1.3. synk request/response</a></li>
                                    <li><a href="#_async_meldingsmottak">4.1.4. async meldingsmottak</a></li>
                                    <li><a href="#_asynkron_lesing_fra_meldingskø">4.1.5. Asynkron lesing fra
                                        meldingskø</a></li>
                                    <li><a href="#_integrasjon_mot_datavarehus">4.1.6. Integrasjon mot Datavarehus</a>
                                    </li>
                                </ul>
                            </li>
                            <li><a href="#_melding_mottak">4.2. Melding mottak</a></li>
                            <li><a href="#_melding_publisering">4.3. Melding publisering</a></li>
                            <li><a href="#_konsumenttjenester">4.4. Konsumenttjenester</a></li>
                            <li><a href="#_produsenttjenester">4.5. Produsenttjenester</a></li>
                            <li><a href="#_tps_integrasjon">4.6. TPS integrasjon</a>
                                <ul class="sectlevel3">
                                    <li><a href="#_hensikt">4.6.1. Hensikt</a></li>
                                    <li><a href="#_hvordan">4.6.2. Hvordan</a></li>
                                    <li><a href="#_lagring">4.6.3. Lagring</a></li>
                                </ul>
                            </li>
                            <li><a href="#_dokprod_integrasjon">4.7. Dokprod integrasjon</a>
                                <ul class="sectlevel3">
                                    <li><a href="#_hensikt_2">4.7.1. Hensikt</a></li>
                                    <li><a href="#_hvordan_2">4.7.2. Hvordan</a></li>
                                </ul>
                            </li>
                            <li><a href="#_gosys_integrasjon">4.8. Gosys integrasjon</a>
                                <ul class="sectlevel3">
                                    <li><a href="#_hensikten_gosys_integrasjoner_er_å_understøtte_at">4.8.1. Hensikten
                                        GOSYS-integrasjoner er å understøtte at</a></li>
                                    <li><a href="#_hvordan_vi_integrerer">4.8.2. Hvordan vi integrerer</a></li>
                                    <li><a href="#_lagring_3">4.8.3. Lagring</a></li>
                                </ul>
                            </li>
                            <li><a href="#_gsak_integrasjon">4.9. GSAK integrasjon</a>
                                <ul class="sectlevel3">
                                    <li><a href="#_hensikt_3">4.9.1. Hensikt</a></li>
                                    <li><a href="#_hvordan_3">4.9.2. Hvordan</a></li>
                                    <li><a href="#_lagring_4">4.9.3. Lagring</a></li>
                                </ul>
                            </li>
                            <li><a href="#_infotrygd_integrasjon">4.10. Infotrygd integrasjon</a>
                                <ul class="sectlevel3">
                                    <li><a href="#_hensikt_4">4.10.1. Hensikt</a></li>
                                    <li><a href="#_hvordan_4">4.10.2. Hvordan</a></li>
                                    <li><a href="#_lagring_5">4.10.3. Lagring</a></li>
                                    <li><a href="#_annet_2">4.10.4. Annet</a></li>
                                </ul>
                            </li>
                            <li><a href="#_inntektskomponenten_integrasjon">4.11. Inntektskomponenten integrasjon</a>
                                <ul class="sectlevel3">
                                    <li><a href="#_hensikt_5">4.11.1. Hensikt</a></li>
                                    <li><a href="#_hvordan_5">4.11.2. Hvordan</a></li>
                                    <li><a href="#_lagring_6">4.11.3. Lagring</a></li>
                                    <li><a href="#_annet_3">4.11.4. Annet</a></li>
                                </ul>
                            </li>
                            <li><a href="#_joark_integrasjon">4.12. Joark integrasjon</a>
                                <ul class="sectlevel3">
                                    <li><a href="#_hensikt_6">4.12.1. Hensikt</a></li>
                                    <li><a href="#_hvordan_6">4.12.2. Hvordan</a></li>
                                </ul>
                            </li>
                            <li><a href="#_medl2_integrasjon">4.13. Medl2 integrasjon</a>
                                <ul class="sectlevel3">
                                    <li><a href="#_hensikt_7">4.13.1. Hensikt</a></li>
                                    <li><a href="#_hvordan_7">4.13.2. Hvordan</a></li>
                                    <li><a href="#_lagring_7">4.13.3. Lagring</a></li>
                                </ul>
                            </li>
                            <li><a href="#_norg2_integrasjon">4.14. Norg2 integrasjon</a>
                                <ul class="sectlevel3">
                                    <li><a href="#_hensikt_8">4.14.1. Hensikt</a></li>
                                    <li><a href="#_hvordan_8">4.14.2. Hvordan</a></li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li><a href="#_sikkerhet">5. Sikkerhet</a>
                        <ul class="sectlevel2">
                            <li><a href="#_abac">5.1. ABAC</a>
                                <ul class="sectlevel3">
                                    <li><a href="#_arkitektur">5.1.1. Arkitektur</a></li>
                                    <li><a href="#_implementasjon_av_abac_i_vedtaksløsningen">5.1.2. Implementasjon av
                                        ABAC i Vedtaksløsningen</a></li>
                                </ul>
                            </li>
                            <li><a href="#_abac_policy_for_engangsstønad">5.2. ABAC Policy for Engangsstønad</a></li>
                            <li><a href="#_bruk_av_3_generasjons_web_services">5.3. Bruk av 3. generasjons web
                                services</a>
                                <ul class="sectlevel3">
                                    <li><a href="#_generelt">5.3.1. Generelt</a></li>
                                    <li><a href="#_teknisk">5.3.2. Teknisk</a></li>
                                </ul>
                            </li>
                            <li><a href="#_pålogging_intern_single_sign_on">5.4. Pålogging - Intern Single Sign On</a>
                                <ul class="sectlevel3">
                                    <li><a href="#_beskrivelse_av_intern_single_sign_on">5.4.1. Beskrivelse av intern
                                        single sign on</a></li>
                                    <li><a href="#_flyt_av_tokens_og_autentiseringsinformasjon">5.4.2. Flyt av tokens og
                                        autentiseringsinformasjon</a></li>
                                    <li><a href="#_sertifikathåndtering">5.4.3. Sertifikathåndtering</a></li>
                                    <li><a href="#_oppsett_av_web_xml">5.4.4. Oppsett av web.xml</a></li>
                                </ul>
                            </li>
                            <li><a href="#_roller_ad_grupper">5.5. Roller/AD-grupper</a>
                                <ul class="sectlevel3">
                                    <li><a href="#_gruppenavn_i_ad">5.5.1. Gruppenavn i AD</a></li>
                                    <li><a href="#_fortrolig_kode_7_strengt_fortrolig_kode_6_og_egen_ansatt">5.5.2.
                                        Fortrolig (Kode 7), Strengt fortrolig (Kode 6) og egen ansatt</a></li>
                                    <li><a href="#_gruppenavn_i_ad_2">5.5.3. Gruppenavn i AD</a></li>
                                    <li><a href="#_andre_ad_grupper_bruker_må_være_meldt_inn_i">5.5.4. Andre AD grupper
                                        bruker må være meldt inn i</a></li>
                                </ul>
                            </li>
                            <li><a href="#_vurdering_av_kvalitetskrav">5.6. Vurdering av kvalitetskrav</a></li>
                        </ul>
                    </li>
                    <li><a href="#_monitorering">6. Monitorering</a>
                        <ul class="sectlevel2">
                            <li><a href="#_logging">6.1. Logging</a>
                                <ul class="sectlevel3">
                                    <li><a href="#_retningslinjer_for_logging">6.1.1. Retningslinjer for Logging</a>
                                    </li>
                                    <li><a href="#_logging_på_info_nivå">6.1.2. Logging på INFO nivå</a></li>
                                    <li><a href="#_logging_på_warn_nivå">6.1.3. Logging på WARN nivå</a></li>
                                    <li><a href="#_logging_på_error_nivå">6.1.4. Logging på ERROR nivå</a></li>
                                    <li><a href="#_sporbarhetslogging">6.1.5. Sporbarhetslogging</a></li>
                                    <li><a href="#_kontekst_informasjon_for_logging">6.1.6. Kontekst informasjon for
                                        logging</a></li>
                                    <li><a href="#_oppstartsinformasjon">6.1.7. Oppstartsinformasjon</a></li>
                                    <li><a href="#_teknisk_2">6.1.8. Teknisk</a></li>
                                </ul>
                            </li>
                            <li><a href="#_overvåkning">6.2. Overvåkning</a>
                                <ul class="sectlevel3">
                                    <li><a href="#_selftest">6.2.1. Selftest</a></li>
                                    <li><a href="#_metrikker">6.2.2. Metrikker</a></li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                </ul>
            </li>
            <li><a href="#_database">Database</a>
                <ul class="sectlevel1">
                    <li><a href="#_diagrammer">7. Diagrammer</a></li>
                </ul>
            </li>
            <li><a href="#_konfigurasjon">Konfigurasjon</a></li>
        </ul>
    </div>
</div>
<div id="content">
    <h1 class="sect0" id="_intro"><a class="anchor" href="#_intro"></a><a class="link" href="#_intro">Intro</a></h1>
    <div class="openblock partintro">
        <div class="content">
            Dette dokumentet inneholder auto-generert systemdokumentasjon for Foreldrepenger Saksbehandlingsløsningen.
        </div>
    </div>
    <div class="sect1">
        <h2 id="_format"><a class="anchor" href="#_format"></a><a class="link" href="#_format">1. Format</a></h2>
        <div class="sectionbody">
            <div class="paragraph">
                <p>Dokumentasjonen genereres til <a href="http://asciidoctor.org/">Asciidoc</a> format, som så kan
                    prosesseres vha. valgt template til HTML, PDF, eller annet. Asciidoc er et markup format lagd for å
                    kunne generere dokumentasjon, bøker, presentasjoner og mer. Det benyttes bla. Git, Spring, Jboss, og
                    forfattere og forleggere.</p>
            </div>
            <div class="paragraph">
                <p>NB: Pass på å sette encoding til UTF-8 dersom det legges til egne sider i dokumentasjonen ('*.adoc').
                    Merk at Windows setter ikke dette default for nye filer.</p>
            </div>
        </div>
    </div>
    <div class="sect1">
        <h2 id="_toolchain"><a class="anchor" href="#_toolchain"></a><a class="link" href="#_toolchain">2. Toolchain</a>
        </h2>
        <div class="sectionbody">
            <div class="paragraph">
                <p>Følgende verktøy benyttes til å trekke ut struktur fra kodebasen og generere dokumentasjonen:</p>
            </div>
            <div class="ulist">
                <ul>
                    <li>
                        <p>Javadoc for å tolke java kildekode og kommentarer, inkludert custom <a
                                href="http://docs.oracle.com/javase/8/docs/technotes/guides/javadoc/doclet/overview.html">Doclets</a>
                            for å trekke ut bestemte deler av strukturer av Java kode og Database</p>
                    </li>
                    <li>
                        <p><a href="https://github.com/Swagger2Markup/swagger2markup">Swagger2Markup</a> for å generere
                            dokumentasjon av REST baserte tjenester</p>
                    </li>
                    <li>
                        <p>React-docgen + React-asciidoc-generator for å generere React dokumentasjon.</p>
                    </li>
                </ul>
            </div>
        </div>
    </div>
    <h1 class="sect0" id="_applikasjon"><a class="anchor" href="#_applikasjon"></a><a class="link" href="#_applikasjon">Applikasjon</a>
    </h1>
    <div class="sect1">
        <h2 id="_applikasjonsarkitektur"><a class="anchor" href="#_applikasjonsarkitektur"></a><a class="link"
                                                                                                  href="#_applikasjonsarkitektur">3.
            Applikasjonsarkitektur</a></h2>
        <div class="sectionbody">

        </div>
    </div>
    <div class="sect1">
        <h2 id="_integrasjon"><a class="anchor" href="#_integrasjon"></a><a class="link" href="#_integrasjon">4.
            Integrasjon</a></h2>
        <div class="sectionbody">
            <div class="sect2">
                <h3 id="_patterns"><a class="anchor" href="#_patterns"></a><a class="link" href="#_patterns">4.1.
                    Patterns</a></h3>
                <div class="sect3">
                    <h4 id="_fire_and_forget"><a class="anchor" href="#_fire_and_forget"></a><a class="link"
                                                                                                href="#_fire_and_forget">4.1.1.
                        fire and forget</a></h4>
                    <div class="paragraph">
                        <p>Fire and Forget er et integrasjonspattern hvor avsender sender en melding til mottaker, og
                            man ikke forventer å få tilbake en response. En slik integrasjon er stateless.</p>
                    </div>
                    <div class="sect4">
                        <h5 id="_integrasjoner_med_fire_forget"><a class="anchor"
                                                                   href="#_integrasjoner_med_fire_forget"></a><a
                                class="link" href="#_integrasjoner_med_fire_forget">Integrasjoner med fire &amp;
                            forget</a></h5>
                        <div class="paragraph">
                            <p><strong>SakOgBehandling</strong></p>
                        </div>
                        <div class="paragraph">
                            <p>Integrasjonene mot SakOgBehandling skjer med JMS, hvor VL sender JMS-melding ved
                                oppdatering og avslutting av Behandlinger</p>
                        </div>
                        <div class="paragraph">
                            <p><strong>Grensesnittavstemming</strong></p>
                        </div>
                        <div class="paragraph">
                            <p>En batch som kjøres daglig som sender avstemmingsmeldinger gjennom JMS til
                                Avstemmingskomponenten til økonomisystemet.</p>
                        </div>
                    </div>
                </div>
                <div class="sect3">
                    <h4 id="_asynk_request_response"><a class="anchor" href="#_asynk_request_response"></a><a
                            class="link" href="#_asynk_request_response">4.1.2. asynk request/response</a></h4>
                    <div class="paragraph">
                        <p>En Requestor starter en forespørslen med å sende en async melding til en Provider. Provider
                            venter på melding og svarer med å sende tilbake en async response melding.</p>
                    </div>
                    <div class="sect4">
                        <h5 id="_Økonomioppdrag"><a class="anchor" href="#_Økonomioppdrag"></a><a class="link"
                                                                                                  href="#_Økonomioppdrag">ØkonomiOppdrag</a>
                        </h5>
                        <div class="paragraph">
                            <p>I Vedtaksløsningen er integrasjonen mot ØkonomiOppdrag async request/response.</p>
                        </div>
                    </div>
                    <div class="sect4">
                        <h5 id="_Økonomioppdragasyncjmsproducer"><a class="anchor"
                                                                    href="#_Økonomioppdragasyncjmsproducer"></a><a
                                class="link" href="#_Økonomioppdragasyncjmsproducer">ØkonomioppdragAsyncJmsProducer</a>
                        </h5>
                        <div class="paragraph">
                            <p>Sender melding til Økonomioppdrag</p>
                        </div>
                        <table class="tableblock frame-all grid-all spread">
                            <colgroup>
                                <col style="width: 33.3333%;">
                                <col style="width: 33.3333%;">
                                <col style="width: 33.3334%;">
                            </colgroup>
                            <thead>
                            <tr>
                                <th class="tableblock halign-left valign-top">kø-alias</th>
                                <th class="tableblock halign-left valign-top">jndi</th>
                                <th class="tableblock halign-left valign-top">TypeMelding</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr>
                                <td class="tableblock halign-left valign-top"><p class="tableblock">
                                    fpsak_okonomi_oppdrag_send</p></td>
                                <td class="tableblock halign-left valign-top"><p class="tableblock">
                                    jms/QueueFpsakOkonomiOppdragSend</p></td>
                                <td class="tableblock halign-left valign-top"><p class="tableblock">TextMelding: <a
                                        href="http://maven.adeo.no/nexus/service/local/repositories/m2internal/content/no/nav/foreldrepenger/kontrakter/okonomistotte-v1/1.5.1/okonomistotte-v1-1.5.1-jaxb.jar">okonomistotte-v1</a>
                                </p></td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="sect4">
                        <h5 id="_Økonomioppdragasyncjmsconsumer"><a class="anchor"
                                                                    href="#_Økonomioppdragasyncjmsconsumer"></a><a
                                class="link" href="#_Økonomioppdragasyncjmsconsumer">ØkonomioppdragAsyncJmsConsumer</a>
                        </h5>
                        <div class="paragraph">
                            <p>Lytter etter og behandler kvitteringsmeldinger fra Økonomioppdrag</p>
                        </div>
                        <table class="tableblock frame-all grid-all spread">
                            <colgroup>
                                <col style="width: 33.3333%;">
                                <col style="width: 33.3333%;">
                                <col style="width: 33.3334%;">
                            </colgroup>
                            <thead>
                            <tr>
                                <th class="tableblock halign-left valign-top">kø-alias</th>
                                <th class="tableblock halign-left valign-top">jndi</th>
                                <th class="tableblock halign-left valign-top">TypeMelding</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr>
                                <td class="tableblock halign-left valign-top"><p class="tableblock">
                                    fpsak_okonomi_oppdrag_mottak</p></td>
                                <td class="tableblock halign-left valign-top"><p class="tableblock">
                                    jms/QueueFpsakOkonomiOppdragMotta</p></td>
                                <td class="tableblock halign-left valign-top"><p class="tableblock">TextMelding: <a
                                        href="http://maven.adeo.no/nexus/service/local/repositories/m2internal/content/no/nav/foreldrepenger/kontrakter/okonomistotte-v1/1.5.1/okonomistotte-v1-1.5.1-jaxb.jar">okonomistotte-v1</a>
                                </p></td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="sect3">
                    <h4 id="_synk_request_response"><a class="anchor" href="#_synk_request_response"></a><a class="link"
                                                                                                            href="#_synk_request_response">4.1.3.
                        synk request/response</a></h4>
                    <div class="paragraph">
                        <p>En requestor kommuniserer synkront mot en tjeneste og forventer en response tilbake. Hvis
                            tjenesten kommuniserer med andre tjenester, så gjøres også dette synkront.</p>
                    </div>
                    <div class="paragraph">
                        <p>Et eksempel på dette er NavAnsattRestTjeneste hvor tjenesten slår opp informasjon i LDAP og
                            returnerer LDAP-dataene tilbake til Requestor.</p>
                    </div>
                </div>
                <div class="sect3">
                    <h4 id="_async_meldingsmottak"><a class="anchor" href="#_async_meldingsmottak"></a><a class="link"
                                                                                                          href="#_async_meldingsmottak">4.1.4.
                        async meldingsmottak</a></h4>
                    <div class="paragraph">
                        <p>Integrasjonspattern hvor mottaker poller en MQ etter nye meldinger, og utfører en handling
                            avhengig av meldingen.</p>
                    </div>
                    <div class="paragraph">
                        <p>For mer detaljert beskrivelse av MQ-intergrasjonen så se: 10.3.5 <a
                                href="https://confluence.adeo.no/pages/viewpage.action?pageId=218415758">Asynkron lesing
                            fra meldingskø</a></p>
                    </div>
                    <div class="sect4">
                        <h5 id="_mottakasyncjmsconsumer"><a class="anchor" href="#_mottakasyncjmsconsumer"></a><a
                                class="link" href="#_mottakasyncjmsconsumer">MottakAsyncJmsConsumer</a></h5>
                        <div class="paragraph">
                            <p>DOKMOT sender notifikasjons over JMS når det kommer nye dokumenter.<br>
                                MottakAsyncJmsConsumer lytter etter disse og oppretter prosesstasker for å hente data
                                fra
                                <a href="https://confluence.adeo.no/display/SVF/10.10.20+Hent+data+fra+Joark">Joark</a>
                            </p>
                        </div>
                        <table class="tableblock frame-all grid-all spread">
                            <colgroup>
                                <col style="width: 33.3333%;">
                                <col style="width: 33.3333%;">
                                <col style="width: 33.3334%;">
                            </colgroup>
                            <thead>
                            <tr>
                                <th class="tableblock halign-left valign-top">kø-alias</th>
                                <th class="tableblock halign-left valign-top">jndi</th>
                                <th class="tableblock halign-left valign-top">TypeMelding</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr>
                                <td class="tableblock halign-left valign-top"><p class="tableblock">
                                    fpsak_mottak_queue</p></td>
                                <td class="tableblock halign-left valign-top"><p class="tableblock">jms/QueueMottak</p>
                                </td>
                                <td class="tableblock halign-left valign-top"><p class="tableblock">TextMelding <a
                                        href="https://confluence.adeo.no/pages/viewpage.action?pageId=205633969">melding:virksomhet:Dokumentnotifikasjon_v1
                                    (2018-HL0)</a></p></td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="sect3">
                    <h4 id="_asynkron_lesing_fra_meldingskø"><a class="anchor"
                                                                href="#_asynkron_lesing_fra_meldingskø"></a><a
                            class="link" href="#_asynkron_lesing_fra_meldingskø">4.1.5. Asynkron lesing fra
                        meldingskø</a></h4>
                    <div class="paragraph">
                        <p>Det er laget generell støtte for meldingsdrevne bønner. Selve konsumerings-loopen vises i
                            diagrammet under.</p>
                    </div>
                    <div class="imageblock">
                        <div class="content">
                            <img alt="Asynkron lesing fra meldingskø" height="337"
                                 src="https://confluence.adeo.no/rest/gliffy/1.0/embeddedDiagrams/eeb78adc-55eb-4a92-b49d-fe736360ad5f.png"
                                 width="735">
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Den abstrakte baseklassen QueueConsumerer midtpunktet i denne generelle støtten, og hver
                            konkrete subklasse kan plugge inn sin egen:</p>
                    </div>
                    <div class="ulist">
                        <ul>
                            <li>
                                <p>ConnectionFactory og Queue</p>
                                <div class="literalblock">
                                    <div class="content">
                                        <pre>Dette er grunnleggende objekter som trengs for å bruke en meldingskø-server og en spesifik kø. Vil typisk slås opp fra JNDI.</pre>
                                    </div>
                                </div>
                            </li>
                            <li>
                                <p>Sjekk av precondtion</p>
                                <div class="literalblock">
                                    <div class="content">
                                        <pre>Typisk vil dette være en sjekk av at eksterne tjenester, database o.l. ikke er nede. Hensikten er å ikke lese meldinger fra kø når vi allerede vet at vi ikke kan håndtere dem. Da reduserer vi sjansen for å bruke opp det veldig begrensede antall leveringsforsøk som meldingskøen tilbyr for hver melding.</pre>
                                    </div>
                                </div>
                            </li>
                            <li>
                                <p>Strategier for feilhåndtering</p>
                                <div class="literalblock">
                                    <div class="content">
                                        <pre>Her kan man logge feil og vente (typisk i noen få sekunder) ved ulike feilsituasjoner.</pre>
                                    </div>
                                </div>
                            </li>
                            <li>
                                <p>Håndtering av melding</p>
                                <div class="literalblock">
                                    <div class="content">
                                        <pre>Den aktuelle funksjonaliteten som skal utføres for en melding,</pre>
                                    </div>
                                </div>
                            </li>
                            <li>
                                <p>Strategi for commit og rollback av melding</p>
                                <div class="literalblock">
                                    <div class="content">
                                        <pre>Her kan man velge mellom de ulike JMS session modes. Baseklassen kommer med en "client acknowledge mode" strategi valgt som default.</pre>
                                    </div>
                                </div>
                            </li>
                        </ul>
                    </div>
                    <div class="paragraph">
                        <p>Hvis en melding avvises med rollback et visst antall ganger (default 3, men konfigurerbart
                            opp til 10 i Fasit), vil meldingskø-serveren gi opp å levere den, og legge den på
                            backout-kø.</p>
                    </div>
                    <div class="paragraph">
                        <p>Start og stopp av konsumerings-loopen trigges av klassen AsyncJmsConsumerStarter, som er
                            knyttet til start og stopp av web-applikasjonen. Alle CDI bønner som arver fra
                            QueueConsumerblir startet/stoppet.</p>
                    </div>
                </div>
                <div class="sect3">
                    <h4 id="_integrasjon_mot_datavarehus"><a class="anchor" href="#_integrasjon_mot_datavarehus"></a><a
                            class="link" href="#_integrasjon_mot_datavarehus">4.1.6. Integrasjon mot Datavarehus</a>
                    </h4>
                    <div class="paragraph">
                        <p>Vedtaksløsningens integrasjon mot NAVs Datavarehus er implementert ved et separat
                            mellomlager-skjema i VL-databasen. VL har fått satt opp skrivetilgang til dette skjemaet, og
                            lagring til det foregår synkront. DVH-bruker er satt opp med leserettigheter. Hver gang en
                            fagsak, behandling o.l. endrer status i VL vil det skrives en tilsvarende rad i
                            mellomlager-databasen.</p>
                    </div>
                    <div class="paragraph">
                        <p>Overordnet ser arkitekturen slik ut:</p>
                    </div>
                    <div class="imageblock">
                        <div class="content">
                            <img alt="Integrasjon mot Datavarehus" height="337" src="images/dv-integrasjon.png"
                                 width="735">
                        </div>
                    </div>
                </div>
            </div>
            <div class="sect2">
                <h3 id="_melding_mottak"><a class="anchor" href="#_melding_mottak"></a><a class="link"
                                                                                          href="#_melding_mottak">4.2.
                    Melding mottak</a></h3>
                <table class="tableblock frame-all grid-all spread">
                    <caption class="title">Table 1. Oversikt</caption>
                    <colgroup>
                        <col style="width: 33.3333%;">
                        <col style="width: 33.3333%;">
                        <col style="width: 33.3334%;">
                    </colgroup>
                    <thead>
                    <tr>
                        <th class="tableblock halign-left valign-top">JNDI_QUEUE</th>
                        <th class="tableblock halign-left valign-top">QUEUE_PREFIX</th>
                        <th class="tableblock halign-left valign-top">Consumer-Class</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">jms/QueueMottak</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">fpsak_mottak_queue</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">MottakAsyncJmsConsumer</p>
                        </td>
                    </tr>
                    <tr>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">
                            jms/QueueFpsakOkonomiOppdragMotta</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">
                            fpsak_okonomi_oppdrag_mottak</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">
                            ØkonomioppdragAsyncJmsConsumer</p></td>
                    </tr>
                    </tbody>
                </table>
            </div>
            <div class="sect2">
                <h3 id="_melding_publisering"><a class="anchor" href="#_melding_publisering"></a><a class="link"
                                                                                                    href="#_melding_publisering">4.3.
                    Melding publisering</a></h3>
                <table class="tableblock frame-all grid-all spread">
                    <caption class="title">Table 2. Oversikt</caption>
                    <colgroup>
                        <col style="width: 33.3333%;">
                        <col style="width: 33.3333%;">
                        <col style="width: 33.3334%;">
                    </colgroup>
                    <thead>
                    <tr>
                        <th class="tableblock halign-left valign-top">JNDI_QUEUE</th>
                        <th class="tableblock halign-left valign-top">QUEUE_PREFIX</th>
                        <th class="tableblock halign-left valign-top">Producer-Class</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">
                            jms/QueueFpsakOkonomiOppdragSend</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">
                            fpsak_okonomi_oppdrag_send</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">
                            ØkonomioppdragJmsProducer</p></td>
                    </tr>
                    <tr>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">
                            jms/QueueFpsakGrensesnittavstemmingSend</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">RAY.AVSTEM_DATA</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">
                            GrensesnittavstemmingJmsProducer</p></td>
                    </tr>
                    <tr>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">jms/QueueSakOgBehandling</p>
                        </td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">SBEH_SAKSBEHANDLING</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">
                            felles/SakOgBehandlingClientImpl</p></td>
                    </tr>
                    </tbody>
                </table>
            </div>
            <div class="sect2">
                <h3 id="_konsumenttjenester"><a class="anchor" href="#_konsumenttjenester"></a><a class="link"
                                                                                                  href="#_konsumenttjenester">4.4.
                    Konsumenttjenester</a></h3>
                <div class="paragraph">
                    <p>Oversikt over konsumerende tjenester.</p>
                </div>
                <table class="tableblock frame-all grid-all spread">
                    <caption class="title">Table 3. Tjenesteoversikt</caption>
                    <colgroup>
                        <col style="width: 20%;">
                        <col style="width: 20%;">
                        <col style="width: 20%;">
                        <col style="width: 20%;">
                        <col style="width: 20%;">
                    </colgroup>
                    <thead>
                    <tr>
                        <th class="tableblock halign-left valign-top">Kortnavn</th>
                        <th class="tableblock halign-left valign-top">System</th>
                        <th class="tableblock halign-left valign-top">Alias</th>
                        <th class="tableblock halign-left valign-top">Link til beskrivelsen</th>
                        <th class="tableblock halign-left valign-top">Beskrivelse</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Arbeidsfordeling</p></td>
                        <td class="tableblock halign-left valign-top"></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">
                            virksomhet:Arbeidsfordeling_v1</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock"><a
                                href="https://confluence.adeo.no/display/SDFS/tjeneste_v3%3Avirksomhet%3AArbeidsfordeling_v1">Beskrivelse</a>
                        </p></td>
                        <td class="tableblock halign-left valign-top"></td>
                    </tr>
                    <tr>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Aktoer</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">TPS</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Aktoer_v2</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock"><a
                                href="https://confluence.adeo.no/display/SDFS/tjeneste_v3%3Avirksomhet%3AAktoer_v2">Beskrivelse</a>
                        </p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock"><strong>HentAktoerIdForIdent:</strong>
                            Brukes ved søk på fødselsnummer, slik at man oversette det til aktørId og slå opp saker.<br>
                            <br>
                            <strong>HentIdentForAktoerId:</strong> Brukes for å hente ut aktørId sitt fødselsnummer.
                            Dette brukes kun som mellomsteg for deretter å kalle hentKjerneinformasjon.</p></td>
                    </tr>
                    <tr>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Person</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">TPS</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">virksomhet:Person_v3</p>
                        </td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock"><a
                                href="https://confluence.adeo.no/display/SDFS/tjeneste_v3%3Avirksomhet%3APerson_v3">Beskrivelse</a>
                        </p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock"><strong>hentKjerneinformasjon:</strong>
                            Brukes gjennomgående i løsningen for å hente ut detaljinformasjon om bruker. Disse dataene
                            etterspørres hver gang av Vedtaksløsningen, dvs. at løsningen ikke persisterer disse dataene
                            selv.</p></td>
                    </tr>
                    <tr>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Journal</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">JOARK</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Journal_v2</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock"><a
                                href="https://confluence.adeo.no/display/SDFS/tjeneste_v3%3Avirksomhet%3AJournal_v2">Beskrivelse</a>
                        </p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">
                            <strong>HentDokument:</strong> Brukes for å hente ut dokument fra journal (JOARK). Brukes
                            både for strukturerte dokumenter (XML) og andre.</p></td>
                    </tr>
                    <tr>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">InngaaendeJournal</p></td>
                        <td class="tableblock halign-left valign-top"></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">InngaaendeJournal_v1</p>
                        </td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock"><a
                                href="https://confluence.adeo.no/display/SDFS/tjeneste_v3%3Avirksomhet%3AInngaaendeJournal_v1">Beskrivelse</a>
                        </p></td>
                        <td class="tableblock halign-left valign-top"></td>
                    </tr>
                    <tr>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">
                            BehandleInngaaendeJournal</p></td>
                        <td class="tableblock halign-left valign-top"></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">
                            BehandleInngaaendeJournal_v1</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock"><a
                                href="https://confluence.adeo.no/display/SDFS/tjeneste_v3%3Avirksomhet%3ABehandleInngaaendeJournal_v1">Beskrivelse</a>
                        </p></td>
                        <td class="tableblock halign-left valign-top"></td>
                    </tr>
                    <tr>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">BehandleSak</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Sak og Behandling</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">
                            virksomhet:BehandleSak_v2</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock"><a
                                href="https://confluence.adeo.no/display/SDFS/tjeneste_v3%3Avirksomhet%3ABehandleSak_v2">Beskrivelse</a>
                        </p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Hendelse:</strong>
                            Meldingstjeneste (fire-and-forget), brukes til å informere Sak og behandling om sak i VL.
                        </p></td>
                    </tr>
                    <tr>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Sak</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">GSAK</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">virksomhet:Sak_v1</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock"><a
                                href="https://confluence.adeo.no/display/SDFS/tjeneste_v3%3Avirksomhet%3ASak_v1">Beskrivelse</a>
                        </p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock"><strong>FinnSak:</strong>
                            Brukes for å finne sak i GSak.</p></td>
                    </tr>
                    <tr>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Behandleoppgave</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">GSAK</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">
                            virksomhet:Behandleoppgave_v1</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock"><a
                                href="https://confluence.adeo.no/pages/viewpage.action?pageId=233382799">Beskrivelse</a>
                        </p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">
                            <strong>OpprettOppgave:</strong> Brukes for å opprette oppgave i Gsak systemet.</p></td>
                    </tr>
                    <tr>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">
                            <strong>FerdigstillOppgave:</strong> Brukes for å ferdigstille oppgave i Gsak systemet.</p>
                        </td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Dokumentproduksjon</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">DOKPROD</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Dokumentproduksjon_v2</p>
                        </td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock"><a
                                href="https://confluence.adeo.no/display/SDFS/tjeneste_v3%3Avirksomhet%3ADokumentproduksjon_v2">Beskrivelse</a>
                        </p></td>
                    </tr>
                    <tr>
                        <td class="tableblock halign-left valign-top"><p class="tableblock"><strong>ProduserDokumentUtkast:</strong>
                            Brukes for å produsere dokument (brev) for forhåndsvisning.<br>
                            <br>
                            <strong>ProduserIkkeRedigerbartDokument:</strong> Brukes for å produsere og sende dokument
                            (brev).</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">InfotrygdSak</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">INFOTRYGD</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">
                            virksomhet:infotrygdsak_v1</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock"><a
                                href="https://confluence.adeo.no/pages/viewpage.action?pageId=213064879">Beskrivelse</a>
                        </p></td>
                    </tr>
                    <tr>
                        <td class="tableblock halign-left valign-top"></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Ytelseskontrakt</p></td>
                        <td class="tableblock halign-left valign-top"></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">
                            virksomhet:Ytelseskontrakt_v3</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock"><a
                                href="https://confluence.adeo.no/display/SDFS/tjeneste_v3%3Avirksomhet%3AYtelseskontrakt_v3">Beskrivelse</a>
                        </p></td>
                    </tr>
                    <tr>
                        <td class="tableblock halign-left valign-top"></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Inntekt</p></td>
                        <td class="tableblock halign-left valign-top"></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">virksomhet:Inntekt_v3</p>
                        </td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock"><a
                                href="https://confluence.adeo.no/display/SDFS/tjeneste_v3%3Avirksomhet%3AInntekt_v3">Beskrivelse</a>
                        </p></td>
                    </tr>
                    <tr>
                        <td class="tableblock halign-left valign-top"></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Medlemskap</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">MEDL2</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">virksomhet:Medlemskap_v2</p>
                        </td>
                        <td class="tableblock halign-left valign-top"></td>
                    </tr>
                    <tr>
                        <td class="tableblock halign-left valign-top"></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Oppgave</p></td>
                        <td class="tableblock halign-left valign-top"></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">virksomhet:Oppgave_v3</p>
                        </td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock"><a
                                href="https://confluence.adeo.no/display/SDFS/tjeneste_v3%3Avirksomhet%3AOppgave_v3">Beskrivelse</a>
                        </p></td>
                    </tr>
                    <tr>
                        <td class="tableblock halign-left valign-top"></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Kodeverk</p></td>
                        <td class="tableblock halign-left valign-top"></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">virksomhet:Kodeverk_v2</p>
                        </td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock"><a
                                href="https://confluence.adeo.no/display/SDFS/tjeneste_v3%3Avirksomhet%3AKodeverk_v2">Beskrivelse</a>
                        </p></td>
                    </tr>
                    </tbody>
                </table>
            </div>
            <div class="sect2">
                <h3 id="_produsenttjenester"><a class="anchor" href="#_produsenttjenester"></a><a class="link"
                                                                                                  href="#_produsenttjenester">4.5.
                    Produsenttjenester</a></h3>
                <div class="paragraph">
                    <p>Tjenester som eksponeres med SOAP-grensesnitt.</p>
                </div>
                <div class="paragraph">
                    <p>Unresolved directive in integrasjon/produsent-tjenester.adoc -
                        include::C:\git\vl-meldingshub\docs/generated/eksponerteTjenester.adoc[]</p>
                </div>
            </div>
            <div class="sect2">
                <h3 id="_tps_integrasjon"><a class="anchor" href="#_tps_integrasjon"></a><a class="link"
                                                                                            href="#_tps_integrasjon">4.6.
                    TPS integrasjon</a></h3>
                <div class="sect3">
                    <h4 id="_hensikt"><a class="anchor" href="#_hensikt"></a><a class="link" href="#_hensikt">4.6.1.
                        Hensikt</a></h4>
                    <div class="paragraph">
                        <p>TPS er NAVs grunndataregister for personinformasjon. Registeret består dels av overføringer
                            fra Det sentrale folkeregister (DSF) og dels av opplysninger om den enkelte bruker som
                            etaten selv har registrert. Vedtaksløsningen benytter TPS for å innhente relevante
                            personopplysninger for alle parter involvert i en behandling, samt bestemme behandlende
                            enhet basert på geografisk tilhørighet.</p>
                    </div>
                </div>
                <div class="sect3">
                    <h4 id="_hvordan"><a class="anchor" href="#_hvordan"></a><a class="link" href="#_hvordan">4.6.2.
                        Hvordan</a></h4>
                    <div class="paragraph">
                        <p>TPS Aksepterer aktørId og fødselsnummer som parametere for å finne personer. Innhenting av
                            personopplysninger gjøres på to måter:</p>
                    </div>
                    <div class="sect4">
                        <h5 id="_førstegangsinnhenting"><a class="anchor" href="#_førstegangsinnhenting"></a><a
                                class="link" href="#_førstegangsinnhenting">Førstegangsinnhenting</a></h5>
                        <div class="paragraph">
                            <p>Behandlingssteget INREG (Innhent registeropplysninger) håndterer førstegangsoppretting av
                                personopplysningen. Da hentes informasjon om hovedsøker, søkers barn, søkers ektefelle
                                og eventuelt annen part i søknaden.</p>
                        </div>
                    </div>
                    <div class="sect4">
                        <h5 id="_oppdatering"><a class="anchor" href="#_oppdatering"></a><a class="link"
                                                                                            href="#_oppdatering">Oppdatering</a>
                        </h5>
                        <div class="paragraph">
                            <p>Enkelte aksjoner krever at det sjekkes for oppdatering av personopplysning. Her sjekkes
                                det først om personopplysningene er utgåtte, basert på en konfigurerbar verdi. Deretter
                                om søker eller medsøker har endret seg, ved å sammenligne det oppdaterte svaret fra TPS
                                med opplysningene som ligger på behandlingen.</p>
                        </div>
                    </div>
                </div>
                <div class="sect3">
                    <h4 id="_lagring"><a class="anchor" href="#_lagring"></a><a class="link" href="#_lagring">4.6.3.
                        Lagring</a></h4>
                    <div class="paragraph">
                        <p>Tabeller som lagrer personinformasjon:</p>
                    </div>
                    <div class="ulist">
                        <ul>
                            <li>
                                <p>Bruker - AktørId og personopplysningmapping</p>
                            </li>
                            <li>
                                <p>Familierelasjon - Representerer relasjoner mellom personopplysninger</p>
                            </li>
                            <li>
                                <p>Opplysning_adresse - Adresseobjekter som hører til personopplysningen</p>
                            </li>
                            <li>
                                <p>Personopplysning - All personopplysningdata som ikke har egne tabeller</p>
                            </li>
                            <li>
                                <p>Valgt_opplysning - Siste valgtOpplysning fra TPS</p>
                            </li>
                            <li>
                                <p>Aktoer_Norsk_ident_Map - AktørId og norsk ident map</p>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="sect2">
                <h3 id="_dokprod_integrasjon"><a class="anchor" href="#_dokprod_integrasjon"></a><a class="link"
                                                                                                    href="#_dokprod_integrasjon">4.7.
                    Dokprod integrasjon</a></h3>
                <div class="sect3">
                    <h4 id="_hensikt_2"><a class="anchor" href="#_hensikt_2"></a><a class="link" href="#_hensikt_2">4.7.1.
                        Hensikt</a></h4>
                    <div class="paragraph">
                        <p>Dokumentproduksjon er NAVs interne tjeneste for produsering av dokumenter for vilkårlige
                            fagsystemer. Tjenesten tilbyr funksjonalitet rundt dokumentproduksjon slik at brukeren skal
                            kunne produsere dokument basert på bestillingsinformasjon og brevdata fagsystemet har gitt.
                            Når vedtaksløsningen trenger å sende eller forhåndsvise brev benyttes denne tjenesten.</p>
                    </div>
                </div>
                <div class="sect3">
                    <h4 id="_hvordan_2"><a class="anchor" href="#_hvordan_2"></a><a class="link" href="#_hvordan_2">4.7.2.
                        Hvordan</a></h4>
                    <div class="sect4">
                        <h5 id="_produksjon_av_dokument"><a class="anchor" href="#_produksjon_av_dokument"></a><a
                                class="link" href="#_produksjon_av_dokument">Produksjon av dokument</a></h5>
                        <div class="paragraph">
                            <p>Brev produseres ved hjelp av tjenesten ProduserIkkeRedigerbartDokument i
                                Dokumentproduksjon_v2. Hvem som skal motta brev spesifiseres av
                                DOKUMENT_MOTTAKER-tabellen. Dette kan være søker og/eller verge. Requesten til
                                ProduserIkkeRedigerbartDokument tar to felt: Dokumentbestillingsinformasjon og Brevdata
                                (xml). Begge disse mappes opp basert på innhold i DOKUMENT_DATA- og
                                DOKUMENT_FELLES-tabellene. DOKUMENT_DATA inneholder informasjon om hvilken behandling
                                brevet gjelder, hvilken brevmal som skal brukes, tidspunkt for når dokumentet ble
                                bestilt, og når det ble produsert. I DOKUMENT_FELLES finner vi informasjon som er
                                relevant for hver enkelt dokumentmottaker.</p>
                        </div>
                    </div>
                    <div class="sect4">
                        <h5 id="_forhåndsvisning_av_dokument"><a class="anchor"
                                                                 href="#_forhåndsvisning_av_dokument"></a><a
                                class="link" href="#_forhåndsvisning_av_dokument">Forhåndsvisning av dokument</a></h5>
                        <div class="paragraph">
                            <p>Tjenesten ProduserDokumentUtkast i Dokumentproduksjon_v2 brukes til å forhåndsvise brev.
                                Denne tjenesten tar to parametere: dokumenttypeId (hvilken dokumentmal som skal brukes)
                                og brevdata (xml). Brevdata mappes opp som for produksjon av dokument.</p>
                        </div>
                    </div>
                    <div class="sect4">
                        <h5 id="_lagring_2"><a class="anchor" href="#_lagring_2"></a><a class="link" href="#_lagring_2">Lagring</a>
                        </h5>
                        <div class="paragraph">
                            <p>All informasjonen som sendes inn til dokprod-tjenestene finner vi i DOKUMENT_DATA- og
                                DOKUMENT_FELLES-tabellene. Når vi mottar responsen fra dokprod settes DOKUMENT_ID og
                                JOURNALPOST_ID i DOKUMENT_FELLES-tabellen.</p>
                        </div>
                    </div>
                    <div class="sect4">
                        <h5 id="_dokumentbestiller_hvordan_legge_til_ny_dokumentmal"><a class="anchor"
                                                                                        href="#_dokumentbestiller_hvordan_legge_til_ny_dokumentmal"></a><a
                                class="link" href="#_dokumentbestiller_hvordan_legge_til_ny_dokumentmal">Dokumentbestiller
                            - hvordan legge til ny dokumentmal</a></h5>
                        <div class="paragraph">
                            <p>Beskriver hva som må gjøres i Dokumentbestilleren for å kunne ta i bruk en ny
                                dokumenttype (dokumentmal) for forhåndsvisning og produksjon av dokument (brev).</p>
                        </div>
                        <div class="paragraph">
                            <p>Utgangspunktet er at det foreligger en ny dokumenttype, i form av et XML-skjema fra
                                DokProd. Anta at skjemaet har navn 0000xx.xsd.</p>
                        </div>
                        <div class="olist arabic">
                            <ol class="arabic">
                                <li>
                                    <p>Ta inn skjema i dokumentbestiller-xsd</p>
                                    <div class="ulist">
                                        <ul>
                                            <li>
                                                <p>Importere xsd til mappen xsd, navn foreldrepenger_0000xx.xsd</p>
                                            </li>
                                            <li>
                                                <p>Oppdatere pom for bygging</p>
                                            </li>
                                            <li>
                                                <p>Bygg</p>
                                            </li>
                                        </ul>
                                    </div>
                                </li>
                                <li>
                                    <p>Oppdater dokumentbestiller-api</p>
                                    <div class="ulist">
                                        <ul>
                                            <li>
                                                <p>Implementere DokumentType med flettefelter, etter mønster av
                                                    tidligere implementasjoner.</p>
                                            </li>
                                            <li>
                                                <p>Enkle dokumenttyper kan benytte implementasjonen StandardDokument
                                                    uten endring.</p>
                                            </li>
                                        </ul>
                                    </div>
                                </li>
                                <li>
                                    <p>Oppdatere dokumentbestiller-impl</p>
                                    <div class="ulist">
                                        <ul>
                                            <li>
                                                <p>Implementere DokumentTypeMapper:</p>
                                                <div class="ulist">
                                                    <ul>
                                                        <li>
                                                            <p>Håndtere flettefelter i mapFagType() etter mønster av
                                                                tidligere implementasjoner</p>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </li>
                                            <li>
                                                <p>Legg til mapperen med riktig malnavn i DokumentTypeRuter</p>
                                            </li>
                                        </ul>
                                    </div>
                                </li>
                                <li>
                                    <p>Verifikasjon og test</p>
                                    <div class="ulist">
                                        <ul>
                                            <li>
                                                <p>Opprette/lagre dokumentdata:</p>
                                                <div class="ulist">
                                                    <ul>
                                                        <li>
                                                            <p>Kall lagreDokumentData() (i interface
                                                                DokumentDataTjeneste)</p>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </li>
                                            <li>
                                                <p>Generere dokument for forhåndsvisning:</p>
                                                <div class="ulist">
                                                    <ul>
                                                        <li>
                                                            <p>Kall forhandsvisDokument() (i interface
                                                                DokumentBestillerApplikasjonTjeneste)</p>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </li>
                                            <li>
                                                <p>Produsere dokument (sende):</p>
                                                <div class="ulist">
                                                    <ul>
                                                        <li>
                                                            <p>Kall produserDokument() (i interface
                                                                DokumentBestillerApplikasjonTjeneste)</p>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </li>
                                        </ul>
                                    </div>
                                </li>
                            </ol>
                        </div>
                    </div>
                    <div class="sect4">
                        <h5 id="_annet"><a class="anchor" href="#_annet"></a><a class="link" href="#_annet">Annet</a>
                        </h5>
                        <div class="paragraph">
                            <p>Lenke til dokumentasjon av tjeneste<br>
                                <a href="https://confluence.adeo.no/pages/viewpage.action?pageId=205634878">tjeneste_v3:virksomhet:Dokumentproduksjon_v2
                                    (2018-HL0)</a></p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="sect2">
                <h3 id="_gosys_integrasjon"><a class="anchor" href="#_gosys_integrasjon"></a><a class="link"
                                                                                                href="#_gosys_integrasjon">4.8.
                    Gosys integrasjon</a></h3>
                <div class="sect3">
                    <h4 id="_hensikten_gosys_integrasjoner_er_å_understøtte_at"><a class="anchor"
                                                                                   href="#_hensikten_gosys_integrasjoner_er_å_understøtte_at"></a><a
                            class="link" href="#_hensikten_gosys_integrasjoner_er_å_understøtte_at">4.8.1. Hensikten
                        GOSYS-integrasjoner er å understøtte at</a></h4>
                    <div class="ulist">
                        <ul>
                            <li>
                                <p>saksbehandler kan manuelt opprette sak</p>
                            </li>
                            <li>
                                <p>saksbehandler kan knytte dokumenter til en sak</p>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="sect3">
                    <h4 id="_hvordan_vi_integrerer"><a class="anchor" href="#_hvordan_vi_integrerer"></a><a class="link"
                                                                                                            href="#_hvordan_vi_integrerer">4.8.2.
                        Hvordan vi integrerer</a></h4>
                    <div class="ulist">
                        <ul>
                            <li>
                                <p>Vi tilbyr webservice som GOSYS kaller på</p>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="sect3">
                    <h4 id="_lagring_3"><a class="anchor" href="#_lagring_3"></a><a class="link" href="#_lagring_3">4.8.3.
                        Lagring</a></h4>
                    <div class="ulist">
                        <ul>
                            <li>
                                <p>Opprett sak medfører at vi lagrer en sak hos oss (og i GSAK).</p>
                            </li>
                            <li>
                                <p>Knytte dokumenter til sak medfører at vi lagrer dokument til
                                    saksbehandlingslageret.</p>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="sect2">
                <h3 id="_gsak_integrasjon"><a class="anchor" href="#_gsak_integrasjon"></a><a class="link"
                                                                                              href="#_gsak_integrasjon">4.9.
                    GSAK integrasjon</a></h3>
                <div class="sect3">
                    <h4 id="_hensikt_3"><a class="anchor" href="#_hensikt_3"></a><a class="link" href="#_hensikt_3">4.9.1.
                        Hensikt</a></h4>
                    <div class="paragraph">
                        <p>GSAK er NAVs sentrale system for opprettelse av oppgaver, som forskjellige fagsystemer
                            registrerer saker som kan følges opp av saksbehandler. Når det i Vedtaksløsningen oppstår en
                            manuell oppgave i forbindelse med en Fagsak eller Behandling, så skal det opprettes en
                            oppgave for dette i GSAK. Fra GSAK skal man da bli rutet tilbake til Vedtaksløsningen
                            gjennom hyperlink.</p>
                    </div>
                </div>
                <div class="sect3">
                    <h4 id="_hvordan_3"><a class="anchor" href="#_hvordan_3"></a><a class="link" href="#_hvordan_3">4.9.2.
                        Hvordan</a></h4>
                    <div class="sect4">
                        <h5 id="_opprettelse_av_sak_i_gsak"><a class="anchor" href="#_opprettelse_av_sak_i_gsak"></a><a
                                class="link" href="#_opprettelse_av_sak_i_gsak">Opprettelse av Sak i GSAK</a></h5>
                        <div class="paragraph">
                            <p>Ved mottak av søknad fra DOKMOT skal Vedtaksløsningen opprette sak i GSAK, gitt at VL kan
                                håndtere søknaden. VLs mottak vil først opprette en Fagsak før den knyttes mot GSAK.</p>
                        </div>
                        <div class="ulist">
                            <div class="title">Knytningen mellom GSAKs Sak og VLs Fagsak skjer på følgende måte:</div>
                            <ul>
                                <li>
                                    <p>VL angir referanse til Fagsak.id ved opprettelse.</p>
                                </li>
                                <li>
                                    <p>GSAK returnerer Sak.SakId som lagres på VLs Fagsak.saksnummer.</p>
                                </li>
                            </ul>
                        </div>
                        <div class="paragraph">
                            <p><em>Merk: Kommunikasjon mellom VL og GSAK er asynkron. Dvs. at den skjer gjennom
                                ProsessTask som vil kalle GSAK sitt grensesnitt, og dette skjer i etterkant av
                                transaksjonen som oppretter tasken. Ved eventuell feil vil tasken fortsette å prøve
                                etter angitt feilhåndteringsalgoritme. <a
                                        href="http://foreldrepengerporten.adeo.no/docs/sysdoc/html/index.html#_oppgavebehandling">oppgavebehandling</a></em>
                            </p>
                        </div>
                    </div>
                </div>
                <div class="sect3">
                    <h4 id="_lagring_4"><a class="anchor" href="#_lagring_4"></a><a class="link" href="#_lagring_4">4.9.3.
                        Lagring</a></h4>
                    <div class="sect4">
                        <h5 id="_kobling_mellom_oppgave_i_gsak_og_behandling_i_vedtaksløsning"><a class="anchor"
                                                                                                  href="#_kobling_mellom_oppgave_i_gsak_og_behandling_i_vedtaksløsning"></a><a
                                class="link" href="#_kobling_mellom_oppgave_i_gsak_og_behandling_i_vedtaksløsning">Kobling
                            mellom Oppgave i GSAK og Behandling i Vedtaksløsning</a></h5>
                        <div class="paragraph">
                            <p>Når VL under Behandling oppretter et Aksjonspunkt, skal dette håndteres manuelt at
                                saksbehandler, og må derfor varsles til GSAK. VL kobler en Behandling til en
                                OppgaveÅrsak gjennom OppgaveBehandlingKobling, og som sendes til GSAK. Eksempler på
                                OppgaveÅrsak er Behandle sak, Registrerere søknad.</p>
                        </div>
                        <div class="paragraph">
                            <p>Det opprettes maksimum ett innslag av hver type OppgaveÅrsak. GSAK får ikke nye oppgaver
                                hvis samme oppgave forsøkes opprettes flere ganger. Oppgaver skal avsluttes når VL er
                                ferdig med behandlingen (Iverksette vedtak).</p>
                        </div>
                        <div class="ulist">
                            <div class="title">Knytningen mellom GSAKs Oppgave og VLs Behandling skjer på følgende
                                måte:
                            </div>
                            <ul>
                                <li>
                                    <p>VL angir referanse til Fagsak.id og OppgaveType.kode ved opprettelse.</p>
                                </li>
                                <li>
                                    <p>GSAK returnerer Oppgave. OppgaveId som lagres på VLs
                                        OppgaveBehandlingKobling.oppgave_id.<br>
                                        Hyperlink mellom GSAK og Vedtaksløsningen<br>
                                        Etter at oppgaven er opprettet i GSAK, vil saksbehandler kunne åpne
                                        Fagsak/Behandling gjennom link i GSAK (eller rettere sagt GoSys, som er GSAK
                                        sitt grafiske grensesnitt).</p>
                                </li>
                            </ul>
                        </div>
                        <div class="listingblock">
                            <div class="title">Linken fra GSAK refererer til følgende URL i VL:</div>
                            <div class="content">
                                <pre class="highlight"><code class="language-xml" data-lang="xml">&lt;context_path&gt;/oppgaveredirect?oppgaveId=&lt;oppgaveId&gt;&amp;sakId=&lt;sakId&gt;</code></pre>
                            </div>
                        </div>
                        <div class="ulist">
                            <ul>
                                <li>
                                    <p>context_path: iht. konfigurasjon for rotsti til VL</p>
                                </li>
                                <li>
                                    <p>oppgaveId: Refererer til GSAK sin oppgaveId, lagret lokalt på
                                        OppgaveBehandlingKobling.oppgave_id.</p>
                                </li>
                                <li>
                                    <p>sakId: Referer til Fagsak.id (sic). Vanlig integrasjonspatterns tilsier at GSAK
                                        refererer til sin egen SakId, som er globalt saksnummer for fagsystemene i NAV.
                                        Men dette er ikke tilfelle. De returnerer Fagsak.Id, som ble angitt av VL ved
                                        opprettelse av Sak i GSAK.</p>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="sect2">
                <h3 id="_infotrygd_integrasjon"><a class="anchor" href="#_infotrygd_integrasjon"></a><a class="link"
                                                                                                        href="#_infotrygd_integrasjon">4.10.
                    Infotrygd integrasjon</a></h3>
                <div class="sect3">
                    <h4 id="_hensikt_4"><a class="anchor" href="#_hensikt_4"></a><a class="link" href="#_hensikt_4">4.10.1.
                        Hensikt</a></h4>
                    <div class="paragraph">
                        <p>Infotrygd er NAVs informasjontjeneste for alle opplysninger om trygd. Tjenesten gir
                            informasjon om alle ytelser en person mottar eller har mottatt gjennom NAV. Vedtaksløsningen
                            benytter Infotrygd for å innhente relevante ytelser for søker og eventuell annen forelder,
                            slik at saksbehandler kan vurdere om disse ytelsene kan påvirke behandlingen av
                            søknaden.</p>
                    </div>
                </div>
                <div class="sect3">
                    <h4 id="_hvordan_4"><a class="anchor" href="#_hvordan_4"></a><a class="link" href="#_hvordan_4">4.10.2.
                        Hvordan</a></h4>
                    <div class="paragraph">
                        <p>Kommunikasjonen med Infotrygd foregår mot den synkrone web servicen
                            InfotrygdSak_v1:FinnSakListe og utføres som en del av steget som innhenter
                            registeropplysninger. Integrasjonen er synkron og vil avbryte gjeldende prosess hvis den
                            feiler.</p>
                    </div>
                    <div class="paragraph">
                        <p>VL kaller Infotrygd for søkers fødselsnummer og en konfigurerbar periode tilbake i tid (som
                            per dags dato er 10 måneder). Infotrygd responderer med en liste av saker som ligger i
                            Infotrygd på gitt personnummer og innenfor gitt periode. Denne responsen lagres i
                            XML-format.</p>
                    </div>
                    <div class="paragraph">
                        <p>Responsen prosesseres og lagres deretter strukturert i en egen tabell for videre bruk.</p>
                    </div>
                    <div class="paragraph">
                        <p>Infotrygd kalles på nytt når registeropplysninger oppdateres, for eksempel når en behandling
                            gjennopptas fra vent, hvis det er mer enn en dag siden opplysningene sist ble innhentet.</p>
                    </div>
                </div>
                <div class="sect3">
                    <h4 id="_lagring_5"><a class="anchor" href="#_lagring_5"></a><a class="link" href="#_lagring_5">4.10.3.
                        Lagring</a></h4>
                    <div class="paragraph">
                        <p>Responsen fra tjenesten lagres i tabellen SAKSOPPLYSNING_DOKUMENT i VL-databasen i
                            XML-format. Den prosesserte responsen lagres i BEHANDLING_REL_YTELSER.</p>
                    </div>
                </div>
                <div class="sect3">
                    <h4 id="_annet_2"><a class="anchor" href="#_annet_2"></a><a class="link" href="#_annet_2">4.10.4.
                        Annet</a></h4>
                    <div class="paragraph">
                        <p>Lenke til dokumentasjon av tjeneste:<br>
                            <a href="https://confluence.adeo.no/pages/viewpage.action?pageId=213064879">tjeneste_v3:virksomhet:InfotrygdSak_v1
                                (2018-HL0)</a></p>
                    </div>
                </div>
            </div>
            <div class="sect2">
                <h3 id="_inntektskomponenten_integrasjon"><a class="anchor"
                                                             href="#_inntektskomponenten_integrasjon"></a><a
                        class="link" href="#_inntektskomponenten_integrasjon">4.11. Inntektskomponenten integrasjon</a>
                </h3>
                <div class="paragraph">
                    <p>Inntektskomponenten inneholder inntektsinformasjon. Den tilbyr <a
                            href="https://confluence.adeo.no/pages/viewpage.action?pageId=223071886">Inntekt v3
                        grensesnittet</a>, som er en NAV-tjeneste som gjør kall videre til Skattedirektoratet.</p>
                </div>
                <div class="sect3">
                    <h4 id="_hensikt_5"><a class="anchor" href="#_hensikt_5"></a><a class="link" href="#_hensikt_5">4.11.1.
                        Hensikt</a></h4>
                    <div class="paragraph">
                        <p>Når Vedtaksløsningen skal vurdere om <a
                                href="https://confluence.adeo.no/pages/viewpage.action?pageId=231980999">Medlemskapsvilkåret</a>
                            skal brukes som inngangsvilkår, er inntekt et av kriteriene som sjekkes.</p>
                    </div>
                </div>
                <div class="sect3">
                    <h4 id="_hvordan_5"><a class="anchor" href="#_hvordan_5"></a><a class="link" href="#_hvordan_5">4.11.2.
                        Hvordan</a></h4>
                    <div class="paragraph">
                        <p>Kommunikasjonen med Inntektskomponenten foregår mot den synkrone web servicen
                            tjeneste_v3:virksomhet:Inntekt_v3:HentInntektListeBolk, men utføres som en del av steget som
                            innhenter registeropplysninger. Integrasjonen er synkron og vil avbryte gjeldende prosess
                            hvis den feiler. Det gjøres oppslag for både søker og annen forelder som er oppgitt i
                            søknaden.</p>
                    </div>
                    <div class="paragraph">
                        <p>Det gjøres også sjekk etter endringer i inntektsinformasjonen når registeropplysninger
                            oppdateres.</p>
                    </div>
                </div>
                <div class="sect3">
                    <h4 id="_lagring_6"><a class="anchor" href="#_lagring_6"></a><a class="link" href="#_lagring_6">4.11.3.
                        Lagring</a></h4>
                    <div class="paragraph">
                        <p>Inntektskomponenten returnerer månedsinntekter pr utbetaler. Disse aggregeres opp til én
                            Inntekt pr utbetaler over en periode, før de lagres i INNTEKT-tabellen i VL-databasen.</p>
                    </div>
                    <div class="paragraph">
                        <p>Feltspesifikke kommentarer:</p>
                    </div>
                    <div class="ulist">
                        <ul>
                            <li>
                                <p>YTELSE</p>
                                <div class="ulist">
                                    <ul>
                                        <li>
                                            <p>Settes til true hvis Inntekt er YtelseFraOffentlige eller
                                                PensjonEllerTrygd.</p>
                                        </li>
                                    </ul>
                                </div>
                            </li>
                            <li>
                                <p>UTBETALER</p>
                                <div class="ulist">
                                    <ul>
                                        <li>
                                            <p>Ved ytelse blir det lagret fra beskrivelsen på YtelseFraOffentlige eller
                                                PensjonEllerTrygd.</p>
                                        </li>
                                        <li>
                                            <p>Ved ikke-ytelse vil Aktoer/Virksomhet benyttes, og den kan være AktoerId,
                                                Organisasjon (orgnummer), eller PersonIdent.</p>
                                        </li>
                                    </ul>
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="sect3">
                    <h4 id="_annet_3"><a class="anchor" href="#_annet_3"></a><a class="link" href="#_annet_3">4.11.4.
                        Annet</a></h4>
                    <div class="paragraph">
                        <p>Det er et krav at alle Saksbehandlere har rettighetene 0000-GA-INNTK og
                            0000-GA-INNTK_FORELDRE. Dette for at oppdatering av registeropplysninger ikke skal feile når
                            det trigges av at Saksbehandler åpner en eksisterende sak.</p>
                    </div>
                </div>
            </div>
            <div class="sect2">
                <h3 id="_joark_integrasjon"><a class="anchor" href="#_joark_integrasjon"></a><a class="link"
                                                                                                href="#_joark_integrasjon">4.12.
                    Joark integrasjon</a></h3>
                <div class="sect3">
                    <h4 id="_hensikt_6"><a class="anchor" href="#_hensikt_6"></a><a class="link" href="#_hensikt_6">4.12.1.
                        Hensikt</a></h4>
                    <div class="paragraph">
                        <p>Joark er NAVs journalarkiv. Vedtaksløsningen benytter Joark tjenestene Journal_V2,
                            BehandleinngaaendeJournal_V1 og InngaaendeJournal_V1 til å hente metadata om innkommende
                            søknadsdokumenter og vedlegg, og til å journalføre dokumenter når de behandles i VL.</p>
                    </div>
                </div>
                <div class="sect3">
                    <h4 id="_hvordan_6"><a class="anchor" href="#_hvordan_6"></a><a class="link" href="#_hvordan_6">4.12.2.
                        Hvordan</a></h4>
                    <div class="paragraph">
                        <p>Input og outputverdier for tjenestene er beskrevet i tjenestekatalogen.</p>
                    </div>
                    <div class="paragraph">
                        <p>Journal_V2: <a
                                href="https://confluence.adeo.no/display/SDFS/tjeneste_v3%3Avirksomhet%3AJournal_v2">tjeneste_v3:virksomhet:Journal_v2</a>
                        </p>
                    </div>
                    <div class="paragraph">
                        <p>BehandleinngaaendeJournal_V1 : <a
                                href="https://confluence.adeo.no/display/SDFS/tjeneste_v3%3Avirksomhet%3ABehandleInngaaendeJournal_v1">tjeneste_v3:virksomhet:BehandleInngaaendeJournal_v1</a>
                        </p>
                    </div>
                    <div class="paragraph">
                        <p>InngaaendeJournal_V1: <a
                                href="https://confluence.adeo.no/display/SDFS/tjeneste_v3%3Avirksomhet%3AInngaaendeJournal_v1">tjeneste_v3:virksomhet:InngaaendeJournal_v1</a>
                        </p>
                    </div>
                    <div class="sect4">
                        <h5 id="_behandledokumentservice_oppdaterogferdigstilljournalfoering"><a class="anchor"
                                                                                                 href="#_behandledokumentservice_oppdaterogferdigstilljournalfoering"></a><a
                                class="link" href="#_behandledokumentservice_oppdaterogferdigstilljournalfoering">BehandleDokumentService
                            - oppdaterOgFerdigstillJournalfoering</a></h5>
                        <div class="paragraph">
                            <p>Saksbehandler gjør en manuell knytning av en forsendelse til en eksisterende eller ny sak
                                i vedtaksløsningen. Følgende kall brukes mot Joark:</p>
                        </div>
                        <table class="tableblock frame-all grid-all spread">
                            <colgroup>
                                <col style="width: 33.3333%;">
                                <col style="width: 33.3333%;">
                                <col style="width: 33.3334%;">
                            </colgroup>
                            <thead>
                            <tr>
                                <th class="tableblock halign-left valign-top">tjeneste</th>
                                <th class="tableblock halign-left valign-top">operasjon</th>
                                <th class="tableblock halign-left valign-top">Beskrivelse</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr>
                                <td class="tableblock halign-left valign-top"><p class="tableblock">
                                    InngaaendeJournal_V1</p></td>
                                <td class="tableblock halign-left valign-top"><p class="tableblock">hentJournalpost</p>
                                </td>
                                <td class="tableblock halign-left valign-top"><p class="tableblock">Brukes for å finne
                                    metadata for hoveddokumentet. Hvis hoveddokument er av status Endelig, så sendes
                                    journalposten til ferdigstilling ved å kalle TilJournalføring, som er tilsvarende
                                    TilJournalføringTask, bare synkront.</p></td>
                            </tr>
                            <tr>
                                <td class="tableblock halign-left valign-top"><p class="tableblock">Journal_V2</p></td>
                                <td class="tableblock halign-left valign-top"><p class="tableblock">hentDokument</p>
                                </td>
                                <td class="tableblock halign-left valign-top"><p class="tableblock">Henter opp xml av
                                    hovedokumentet og sender det videre til klargjøringVL. Xml-dokumentet. KlargjøringVL
                                    Dokumentet lagres i saksopplysning_dokument-tabellen og sendes videre til
                                    HåndterMottattDokumentTask. Dette skjer synkront</p></td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="sect4">
                        <h5 id="_ved_mottak_av_dokument"><a class="anchor" href="#_ved_mottak_av_dokument"></a><a
                                class="link" href="#_ved_mottak_av_dokument">Ved mottak av dokument</a></h5>
                        <div class="paragraph">
                            <p>Ved mottak av dokument, så sender dokmot en JMS-melding til VL. VL oppretter en
                                HentDataFraJoarkTask, som håndterer strukturerte og ustrukturerte dokumenter.</p>
                        </div>
                        <div class="paragraph">
                            <p><strong>HentDataFraJoarkTask</strong><br>
                                Asynkron prosesstask for å hente ned metadata og søknadsxml fra Joark før den sendes
                                videre til neste steg i behandlingen. Følgende kall brukes mot Joark:</p>
                        </div>
                        <table class="tableblock frame-all grid-all spread">
                            <colgroup>
                                <col style="width: 33.3333%;">
                                <col style="width: 33.3333%;">
                                <col style="width: 33.3334%;">
                            </colgroup>
                            <thead>
                            <tr>
                                <th class="tableblock halign-left valign-top">tjeneste</th>
                                <th class="tableblock halign-left valign-top">operasjon</th>
                                <th class="tableblock halign-left valign-top">Beskrivelse</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr>
                                <td class="tableblock halign-left valign-top"><p class="tableblock">
                                    InngaaendeJournal_V1</p></td>
                                <td class="tableblock halign-left valign-top"><p class="tableblock">hentJournalpost</p>
                                </td>
                                <td class="tableblock halign-left valign-top"><p class="tableblock">Brukes for å finne
                                    metadata for hoveddokument</p></td>
                            </tr>
                            <tr>
                                <td class="tableblock halign-left valign-top"><p class="tableblock">Journal_V2</p></td>
                                <td class="tableblock halign-left valign-top"><p class="tableblock">hentDokument</p>
                                </td>
                                <td class="tableblock halign-left valign-top"><p class="tableblock">Henter opp xml av
                                    hovedokumentet og sender det videre til klargjøringVL. Xml-dokumentet. Dokumentet
                                    lagres i saksopplysning_dokument-tabellen og sendes videre til
                                    HåndterMottattDokumentTask</p></td>
                            </tr>
                            </tbody>
                        </table>
                        <div class="paragraph">
                            <p><strong>TilJournalføringTask</strong><br>
                                Sjekker om journalposten har mangler for å ferdiigstille journalføring, retter opp i
                                manglene og ferdigstiller hvis mulig. Følgende kall brukes mot Joark:</p>
                        </div>
                        <table class="tableblock frame-all grid-all spread">
                            <colgroup>
                                <col style="width: 33.3333%;">
                                <col style="width: 33.3333%;">
                                <col style="width: 33.3334%;">
                            </colgroup>
                            <thead>
                            <tr>
                                <th class="tableblock halign-left valign-top">tjeneste</th>
                                <th class="tableblock halign-left valign-top">operasjon</th>
                                <th class="tableblock halign-left valign-top">Beskrivelse</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr>
                                <td class="tableblock halign-left valign-top"><p class="tableblock">
                                    InngaaendeJournal_V1</p></td>
                                <td class="tableblock halign-left valign-top"><p class="tableblock">
                                    utledJournalfoeringsbehov</p></td>
                                <td class="tableblock halign-left valign-top"><p class="tableblock">Sjekker om
                                    journalposten har mangler</p></td>
                            </tr>
                            <tr>
                                <td class="tableblock halign-left valign-top"><p class="tableblock">
                                    BehandleinngaaendeJournal_V1</p></td>
                                <td class="tableblock halign-left valign-top"><p class="tableblock">oppdaterJournalpost
                                    Oppdaterer journalposten med manglende</p></td>
                                <td class="tableblock halign-left valign-top"><p class="tableblock">
                                    BehandleinngaaendeJournal_V1</p></td>
                            </tr>
                            </tbody>
                        </table>
                        <div class="paragraph">
                            <p><strong>RegistrerSøknadSteg</strong><br>
                                Ved registrering av mottatt søknad, så opprettes det historikkinnslag i databasen som en
                                del av registeringen av søknad. Følgende kall brukes mot Joark:</p>
                        </div>
                        <table class="tableblock frame-all grid-all spread">
                            <colgroup>
                                <col style="width: 33.3333%;">
                                <col style="width: 33.3333%;">
                                <col style="width: 33.3334%;">
                            </colgroup>
                            <thead>
                            <tr>
                                <th class="tableblock halign-left valign-top">tjeneste</th>
                                <th class="tableblock halign-left valign-top">operasjon</th>
                                <th class="tableblock halign-left valign-top">Beskrivelse</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr>
                                <td class="tableblock halign-left valign-top"><p class="tableblock">
                                    InngaaendeJournal_V1</p></td>
                                <td class="tableblock halign-left valign-top"><p class="tableblock">hentJournalpost</p>
                                </td>
                                <td class="tableblock halign-left valign-top"><p class="tableblock">Henter journalpost
                                    og metadata til journalposten for lagring i historikkinnslag_dokument_link</p></td>
                            </tr>
                            </tbody>
                        </table>
                        <div class="paragraph">
                            <p><strong>KompletthetssjekkTjeneste</strong><br>
                                Ved sjekking av vilkår, så sjekkes det om søknad sendt inn er komplett. Følgende kall
                                brukes mot Joark:</p>
                        </div>
                        <table class="tableblock frame-all grid-all spread">
                            <colgroup>
                                <col style="width: 33.3333%;">
                                <col style="width: 33.3333%;">
                                <col style="width: 33.3334%;">
                            </colgroup>
                            <thead>
                            <tr>
                                <th class="tableblock halign-left valign-top">tjeneste</th>
                                <th class="tableblock halign-left valign-top">operasjon</th>
                                <th class="tableblock halign-left valign-top">Beskrivelse</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr>
                                <td class="tableblock halign-left valign-top"><p class="tableblock">Journal_V2</p></td>
                                <td class="tableblock halign-left valign-top"><p class="tableblock">
                                    hentJournalpostListe</p></td>
                                <td class="tableblock halign-left valign-top"><p class="tableblock">Vi spør Joark om
                                    dokumentliste og sjekker det som finnes i vedleggslisten på søknaden mot det som
                                    ligger i Joark. Vedleggslisten på søknaden regnes altså i denne omgang som fasit på
                                    hva som er påkrevd.</p></td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="sect4">
                        <h5 id="_dokumentresttjeneste"><a class="anchor" href="#_dokumentresttjeneste"></a><a
                                class="link" href="#_dokumentresttjeneste">DokumentRestTjeneste</a></h5>
                        <table class="tableblock frame-all grid-all spread">
                            <colgroup>
                                <col style="width: 33.3333%;">
                                <col style="width: 33.3333%;">
                                <col style="width: 33.3334%;">
                            </colgroup>
                            <thead>
                            <tr>
                                <th class="tableblock halign-left valign-top">tjeneste</th>
                                <th class="tableblock halign-left valign-top">operasjon</th>
                                <th class="tableblock halign-left valign-top">Beskrivelse</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr>
                                <td class="tableblock halign-left valign-top"><p class="tableblock">Journal_V2</p></td>
                                <td class="tableblock halign-left valign-top"><p class="tableblock">hentDokument</p>
                                </td>
                                <td class="tableblock halign-left valign-top"><p class="tableblock">rest-kall
                                    /hent-dokument henter dokumentet. Brukes fra frontend til se dokumenter lagret på
                                    fpsak.</p></td>
                            </tr>
                            <tr>
                                <td class="tableblock halign-left valign-top"><p class="tableblock">Journal_V2</p></td>
                                <td class="tableblock halign-left valign-top"><p class="tableblock">
                                    hentJournalpostListe</p></td>
                                <td class="tableblock halign-left valign-top"><p class="tableblock">rest-kall
                                    /hent-dokumentliste for å hente en liste med alle dokumenter til en sak.</p></td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <div class="sect2">
                <h3 id="_medl2_integrasjon"><a class="anchor" href="#_medl2_integrasjon"></a><a class="link"
                                                                                                href="#_medl2_integrasjon">4.13.
                    Medl2 integrasjon</a></h3>
                <div class="paragraph">
                    <p>MEDL2 er NAVs medlemskapsregister. Det gir informasjon om perioder med eller uten medlemskap i
                        Folketrygden, og hvilken dekninsgrad et medlem har. Integrasjonen går fra Vedtaksløsningen til
                        <a href="https://confluence.adeo.no/display/FEL/MEDL2+-+Tjeneste+Webservice+MedlemskapV2">Medlemskap
                            V2 grensesnittet</a>.</p>
                </div>
                <div class="sect3">
                    <h4 id="_hensikt_7"><a class="anchor" href="#_hensikt_7"></a><a class="link" href="#_hensikt_7">4.13.1.
                        Hensikt</a></h4>
                    <div class="paragraph">
                        <p>Medlemskapsperiodene er sentrale når Vedtaksløsningen skal vurdere <a
                                href="https://confluence.adeo.no/pages/viewpage.action?pageId=231980999">Medlemskapsvilkåret</a>.
                        </p>
                    </div>
                </div>
                <div class="sect3">
                    <h4 id="_hvordan_7"><a class="anchor" href="#_hvordan_7"></a><a class="link" href="#_hvordan_7">4.13.2.
                        Hvordan</a></h4>
                    <div class="paragraph">
                        <p>Kommunikasjonen med MEDL2 foregår mot den synkrone web servicen
                            Medlemskap_v2:HentPeriodeListe, men utføres som en del av steget som innhenter
                            registeropplysninger. Integrasjonen er synkron og vil avbryte gjeldende prosess hvis den
                            feiler.<br>
                            VL kaller MEDL2 for søkers fødselsnummer og lagrer alle treff i perioden fra 1 år før
                            skjæringstidspunktet (termindato, fødselsdato eller dato for omsorgsovertakelse), til et
                            halvt år etter skjæringstidspunktet. Dersom saksbehandler endrer skjæringstidspunktet
                            (fødsel, termin eller dato for omsorg), vil VL på nytt sjekke om denne datoen er innenfor de
                            allerede innhentede periodene, og hente inn registeropplysninger på nytt hvis ikke.<br>
                            Det gjøres også sjekk etter endringer i Medlemskapsperiodene når registeropplysninger
                            oppdateres.</p>
                    </div>
                </div>
                <div class="sect3">
                    <h4 id="_lagring_7"><a class="anchor" href="#_lagring_7"></a><a class="link" href="#_lagring_7">4.13.3.
                        Lagring</a></h4>
                    <div class="paragraph">
                        <p>Medlemskapsperiodene lagres i tabellen MEDLEMSKAP_PERIODER i VL-databasen. Tabellens innhold
                            kan brukes for å vurdere <a
                                    href="https://confluence.adeo.no/pages/viewpage.action?pageId=231980999">Medlemskapsvilkåret</a>
                            både automatisk (regelvurdering) og skjønnsmessig (saksbehandler).</p>
                    </div>
                </div>
            </div>
            <div class="sect2">
                <h3 id="_norg2_integrasjon"><a class="anchor" href="#_norg2_integrasjon"></a><a class="link"
                                                                                                href="#_norg2_integrasjon">4.14.
                    Norg2 integrasjon</a></h3>
                <div class="sect3">
                    <h4 id="_hensikt_8"><a class="anchor" href="#_hensikt_8"></a><a class="link" href="#_hensikt_8">4.14.1.
                        Hensikt</a></h4>
                    <div class="paragraph">
                        <p>NORG2 inneholder informasjon om:</p>
                    </div>
                    <div class="ulist">
                        <ul>
                            <li>
                                <p>NAV-enheter og tilknyttede fagsystembrukere.</p>
                            </li>
                            <li>
                                <p>Arbeidsfordeling knyttet til NAV-enheter. Dvs hvilke enheter som kan ta oppfølgning
                                    av hvilke type saker.</p>
                            </li>
                        </ul>
                    </div>
                    <div class="paragraph">
                        <p>Vedtaksløsningen bruker NORG2 tjenesten Arbeidsfordeling_V1 til å finne riktig behandlende
                            NAV enhet for behandlinger i VL, basert på behandlingstema, brukers geografiske tilknytning
                            og eventuell diskresjonskode.</p>
                    </div>
                </div>
                <div class="sect3">
                    <h4 id="_hvordan_8"><a class="anchor" href="#_hvordan_8"></a><a class="link" href="#_hvordan_8">4.14.2.
                        Hvordan</a></h4>
                    <div class="paragraph">
                        <p>Arbeidsfordeling_V1 er en Webservice basert på SOAP. Input og output er beskrevet i
                            tjenestekatalogen her: <a
                                    href="https://confluence.adeo.no/pages/viewpage.action?pageId=223076038">tjeneste_v3:virksomhet:Arbeidsfordeling_v1
                                (2018-HL0)</a></p>
                    </div>
                    <div class="paragraph">
                        <p>Tjenesten kalles synkront fra den interne VL-tjenesten EnhetsTjeneste.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="sect1">
        <h2 id="_sikkerhet"><a class="anchor" href="#_sikkerhet"></a><a class="link" href="#_sikkerhet">5. Sikkerhet</a>
        </h2>
        <div class="sectionbody">
            <div class="sect2">
                <h3 id="_abac"><a class="anchor" href="#_abac"></a><a class="link" href="#_abac">5.1. ABAC</a></h3>
                <div class="paragraph">
                    <p>Siden beskriver bruken av attributtbasert tilgangskontroll i vedtaksløsning foreldrepenger.</p>
                </div>
                <div class="sect3">
                    <h4 id="_arkitektur"><a class="anchor" href="#_arkitektur"></a><a class="link" href="#_arkitektur">5.1.1.
                        Arkitektur</a></h4>
                    <div class="paragraph">
                        <p>ABAC løsningen til Nav er basert på produktet APS fra Axiomatics. Arkitekturskissen under
                            viser<br>
                            komponenter i løsning relasjoner mellom disse.<br>
                            Du finner mer <a href="https://confluence.adeo.no/pages/viewpage.action?pageId=202356930">informasjon
                                om ABAC</a><br>
                            og Nav sin bruk av produktet her.</p>
                    </div>
                    <div class="imageblock">
                        <div class="content">
                            <img alt="Arkitekturskissen" height="337"
                                 src="https://confluence.adeo.no/rest/gliffy/1.0/embeddedDiagrams/50c92535-65fe-4d73-aea5-ea8f21d80736.png"
                                 width="735">
                        </div>
                    </div>
                </div>
                <div class="sect3">
                    <h4 id="_implementasjon_av_abac_i_vedtaksløsningen"><a class="anchor"
                                                                           href="#_implementasjon_av_abac_i_vedtaksløsningen"></a><a
                            class="link" href="#_implementasjon_av_abac_i_vedtaksløsningen">5.1.2. Implementasjon av
                        ABAC i Vedtaksløsningen</a></h4>
                    <div class="paragraph">
                        <p>Det er utviklet en PEP i Java som er basert på eksempelkode fra Integrasjon.<br>
                            PEP:ene benyttes i en utgangspunkt til å skallsikre løsningen og er plasert i eksponerte
                            REST<br>
                            og WS tjenester. Attributter som benyttes i tilgangskontroll er listet og beskrevet i<br>
                            <a href="https://confluence.adeo.no/pages/viewpage.action?pageId=202354447">ABAC Policy for
                                Engangsstønad</a>.<br>
                            Implementerte policies/regelsett er beskrevet her;<br>
                            <a href="https://confluence.adeo.no/pages/viewpage.action?pageId=221745353">ABAC Klartekst
                                policies for domene "foreldrepenger"</a>.</p>
                    </div>
                    <div class="paragraph">
                        <p>Mer info om kodebasen her: <a
                                href="https://confluence.adeo.no/pages/viewpage.action?pageId=202359262">3.3 ABAC
                            Utviklerhåndbok</a></p>
                    </div>
                </div>
            </div>
            <div class="sect2">
                <h3 id="_abac_policy_for_engangsstønad"><a class="anchor" href="#_abac_policy_for_engangsstønad"></a><a
                        class="link" href="#_abac_policy_for_engangsstønad">5.2. ABAC Policy for Engangsstønad</a></h3>
                <div class="paragraph">
                    <p>Her lister vi attributter som skal brukes av Engangsstønad. En oversikt over alle attributter i
                        Nav<br>
                        finner dere her og beskrivelser av policies finner dere her: <a
                                href="https://confluence.adeo.no/pages/viewpage.action?pageId=221745353">ABAC Klartekst
                            policies for domene<br>
                            "foreldrepenger"</a>. Ark med tilgangsregler er lagt ved.</p>
                </div>
                <table class="tableblock frame-all grid-all spread">
                    <caption class="title">Table 4. Action</caption>
                    <colgroup>
                        <col style="width: 16.6666%;">
                        <col style="width: 16.6666%;">
                        <col style="width: 16.6666%;">
                        <col style="width: 16.6666%;">
                        <col style="width: 16.6666%;">
                        <col style="width: 16.667%;">
                    </colgroup>
                    <thead>
                    <tr>
                        <th class="tableblock halign-left valign-top">Navn</th>
                        <th class="tableblock halign-left valign-top">Id</th>
                        <th class="tableblock halign-left valign-top">Type</th>
                        <th class="tableblock halign-left valign-top">Kategori</th>
                        <th class="tableblock halign-left valign-top">Beskrivelse</th>
                        <th class="tableblock halign-left valign-top">Påkrevd</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">actionId</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">
                            urn:oasis:names:tc:xacml:1.0:action:action-id</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Action</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Aksjon som oenskes
                            utfoert<br>
                            <br>
                            <strong>Lovlige verdier</strong>: create, read, update, delete<br>
                            <br>
                            <strong>Kilde</strong>: PEP</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Ja</p></td>
                    </tr>
                    </tbody>
                </table>
                <table class="tableblock frame-all grid-all spread">
                    <caption class="title">Table 5. Subject</caption>
                    <colgroup>
                        <col style="width: 16.6666%;">
                        <col style="width: 16.6666%;">
                        <col style="width: 16.6666%;">
                        <col style="width: 16.6666%;">
                        <col style="width: 16.6666%;">
                        <col style="width: 16.667%;">
                    </colgroup>
                    <thead>
                    <tr>
                        <th class="tableblock halign-left valign-top">Navn</th>
                        <th class="tableblock halign-left valign-top">Id</th>
                        <th class="tableblock halign-left valign-top">Type</th>
                        <th class="tableblock halign-left valign-top">Kategori</th>
                        <th class="tableblock halign-left valign-top">Beskrivelse</th>
                        <th class="tableblock halign-left valign-top">Påkrevd</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">subjectId</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">
                            urn:oasis:names:tc:xacml:1.0:subject:subject-id</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">AccessSubject</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Subjekt identifiserer den
                            som oensker tilgang , kan vaere fnr, dnr, nav-ident<br>
                            <br>
                            <strong>Eksempelverdier</strong>: 01018012345, x123456<br>
                            <br>
                            <strong>Kilde</strong>: Token</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Nei</p></td>
                    </tr>
                    <tr>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">role</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">
                            urn:oasis:names:tc:xacml:2.0:subject:role</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">AccessSubject</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Rolle som tilordner
                            muligheter for sluttbruker (subjekt)<br>
                            <br>
                            <strong>Eksempelverdier</strong>: 0000-GA-GOSYS_KODE7<br>
                            <br>
                            <strong>Kilde</strong>: Active Directory (AD) via PIP tjeneste</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">N/A, kun PDP som forholder
                            seg til roller</p></td>
                    </tr>
                    </tbody>
                </table>
                <table class="tableblock frame-all grid-all spread">
                    <caption class="title">Table 6. Ressurs/Objekt</caption>
                    <colgroup>
                        <col style="width: 16.6666%;">
                        <col style="width: 16.6666%;">
                        <col style="width: 16.6666%;">
                        <col style="width: 16.6666%;">
                        <col style="width: 16.6666%;">
                        <col style="width: 16.667%;">
                    </colgroup>
                    <thead>
                    <tr>
                        <th class="tableblock halign-left valign-top">Navn</th>
                        <th class="tableblock halign-left valign-top">Id</th>
                        <th class="tableblock halign-left valign-top">Type</th>
                        <th class="tableblock halign-left valign-top">Kategori</th>
                        <th class="tableblock halign-left valign-top">Beskrivelse</th>
                        <th class="tableblock halign-left valign-top">Påkrevd</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">domene</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">
                            no.nav.abac.attributter.resource.felles.domene</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Resource</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Domene for policy og
                            PEP7<br>
                            <br>
                            <strong>Eksempelverdier</strong>: foreldrepenger<br>
                            <br>
                            <strong>Kilde</strong>: PEP</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Ja</p></td>
                    </tr>
                    <tr>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">resource_type</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">
                            no.nav.abac.attributter.resource.felles.resource_type</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Resource</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Beskriver ressurs bruker
                            ønsker tilgang til<br>
                            <br>
                            <strong>Eksempelverdier</strong>:
                            no.nav.abac.attributter.foreldrepenger,no.nav.abac.attributter.foreldrepenger.fagsak<br>
                            <br>
                            <strong>Kilde</strong>:PEP</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Ja</p></td>
                    </tr>
                    <tr>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">fnr</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">&lt;tbd&gt;</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Resource</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">fødselsnummer til søker<br>
                            <br>
                            <strong>Eksempelverdier</strong>: xxx<br>
                            <br>
                            <strong>Kilde</strong>: PEP</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Nei</p></td>
                    </tr>
                    <tr>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">saksstatus</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">&lt;tbd&gt;</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Resource</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Status på sak<br>
                            <br>
                            <strong>Eksempelverdier</strong>: xxx<br>
                            <br>
                            <strong>Kilde</strong>: PEP</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Nei</p></td>
                    </tr>
                    <tr>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">behandlingsstatus</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">&lt;tbd&gt;</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Resource</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Status på behandling<br>
                            <br>
                            <strong>Eksempelverdier</strong>: xxx<br>
                            <br>
                            <strong>Kilde</strong>: PEP</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Nei</p></td>
                    </tr>
                    <tr>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">aksjonspunkt_type</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">&lt;tbd&gt;</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Resource</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Type av aksjonspunkt<br>
                            <br>
                            <strong>Eksempelverdier</strong>: xxx<br>
                            <br>
                            <strong>Kilde</strong>: PEP</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Nei</p></td>
                    </tr>
                    </tbody>
                </table>
                <table class="tableblock frame-all grid-all spread">
                    <caption class="title">Table 7. Environment</caption>
                    <colgroup>
                        <col style="width: 16.6666%;">
                        <col style="width: 16.6666%;">
                        <col style="width: 16.6666%;">
                        <col style="width: 16.6666%;">
                        <col style="width: 16.6666%;">
                        <col style="width: 16.667%;">
                    </colgroup>
                    <thead>
                    <tr>
                        <th class="tableblock halign-left valign-top">Navn</th>
                        <th class="tableblock halign-left valign-top">Id</th>
                        <th class="tableblock halign-left valign-top">Type</th>
                        <th class="tableblock halign-left valign-top">Kategori</th>
                        <th class="tableblock halign-left valign-top">Beskrivelse</th>
                        <th class="tableblock halign-left valign-top">Påkrevd</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">pep_id</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">
                            no.nav.abac.attributter.environment.felles.pep_id</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Environment</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Identitet paa PEP<br>
                            <br>
                            <strong>Eksempelverdier</strong>: srvtpsws<br>
                            <br>
                            <strong>Kilde</strong>:PEP</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Ja</p></td>
                    </tr>
                    <tr>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">oidc_token_body</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">
                            no.nav.abac.attributter.environment.felles.oidc_token_body</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">(Environment)</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Innholdet i OpenID token.
                            JSON format og Base64 encodet.<br>
                            <br>
                            Inneholder subjectid (Nav-id) og AD domene (issuer).<br>
                            <br>
                            <strong>Eksempelverdier</strong>: NA</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Nei, ikke om saml_token er
                            med</p></td>
                    </tr>
                    <tr>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">saml_token</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">
                            no.nav.abac.attributter.environment.felles.saml_token</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Environment</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">SAML token, base64
                            encodet<br>
                            <br>
                            <strong>Eksempelverdier</strong>: NA<br>
                            <br>
                            <strong>Kilde</strong>: PEP</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Nei, ikke om oidc_token_body
                            er med</p></td>
                    </tr>
                    </tbody>
                </table>
            </div>
            <div class="sect2">
                <h3 id="_bruk_av_3_generasjons_web_services"><a class="anchor"
                                                                href="#_bruk_av_3_generasjons_web_services"></a><a
                        class="link" href="#_bruk_av_3_generasjons_web_services">5.3. Bruk av 3. generasjons web
                    services</a></h3>
                <div class="sect3">
                    <h4 id="_generelt"><a class="anchor" href="#_generelt"></a><a class="link" href="#_generelt">5.3.1.
                        Generelt</a></h4>
                    <div class="olist arabic">
                        <ol class="arabic">
                            <li>
                                <p>generasjons web services krever SAML token for å kunne vite brukers identitet
                                    m.m..</p>
                            </li>
                        </ol>
                    </div>
                    <div class="paragraph">
                        <p>Applikasjone henter SAML tokens fra STS på Datapower, ved å utveksle OIDC tokens mottatt fra
                            applikasjonens web-lag. Se full beskrivelse i Pålogging - Intern Single Sign On.</p>
                    </div>
                    <div class="paragraph">
                        <p>Pr. i dag er det laget støtte for dette i applikasjonens klienter mot følgende 3. generasjons
                            web services:</p>
                    </div>
                    <div class="ulist">
                        <ul>
                            <li>
                                <p>Aktør_v2 - <a
                                        href="https://confluence.adeo.no/display/SDFS/tjeneste_v3%3Avirksomhet%3AAktoer_v2">tjeneste_v3:virksomhet:Aktoer_v2</a>
                                </p>
                            </li>
                            <li>
                                <p>Person_v2 - <a
                                        href="https://confluence.adeo.no/display/SDFS/tjeneste_v3%3Avirksomhet%3APerson_v2">tjeneste_v3:virksomhet:Person_v2</a>
                                </p>
                            </li>
                            <li>
                                <p>TODO de nye tjenestene som Bjørn-Tore har laget klienter for</p>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="sect3">
                    <h4 id="_teknisk"><a class="anchor" href="#_teknisk"></a><a class="link" href="#_teknisk">5.3.2.
                        Teknisk</a></h4>
                    <div class="paragraph">
                        <p>Diagrammet under viser de viktigste klassene som brukes ifbm. å skaffe SAML token utfra OICD
                            token. (Klienten for Aktør-tjenesten brukes som eksempel her, men de andre klientene følger
                            samme mønster).</p>
                    </div>
                    <div class="paragraph">
                        <p>Se også <a
                                href="https://confluence.adeo.no/display/SVF/Hvordan+opprette+en+ny+3.+gen.+konsumenttjeneste">Hvordan
                            opprette en ny 3. gen. konsumenttjeneste</a>.</p>
                    </div>
                    <div class="imageblock">
                        <div class="content">
                            <img alt="klassene som brukes ifbm. å skaffe SAML token utfra OICD token" height="337"
                                 src="https://confluence.adeo.no/rest/gliffy/1.0/embeddedDiagrams/727acb43-794a-438c-8598-927a1e7328b9.png"
                                 width="735">
                        </div>
                    </div>
                </div>
            </div>
            <div class="sect2">
                <h3 id="_pålogging_intern_single_sign_on"><a class="anchor"
                                                             href="#_pålogging_intern_single_sign_on"></a><a
                        class="link" href="#_pålogging_intern_single_sign_on">5.4. Pålogging - Intern Single Sign On</a>
                </h3>
                <div class="sect3">
                    <h4 id="_beskrivelse_av_intern_single_sign_on"><a class="anchor"
                                                                      href="#_beskrivelse_av_intern_single_sign_on"></a><a
                            class="link" href="#_beskrivelse_av_intern_single_sign_on">5.4.1. Beskrivelse av intern
                        single sign on</a></h4>
                    <div class="paragraph">
                        <p>Intern single sign on baserer seg på følgende:<br>
                            * Kerberos/SPNEGO-pålogging mot OpenAM<br>
                            * <a href="http://openid.net/specs/openid-connect-core-1_0.html">OpenID Connect Core 1.0</a>,
                            spesifikt brukes Authorization Code flow. OpenID Connect bygger på toppen av OAuth 2.0
                            (RFC-6749).<br>
                            * SAML-token brukes mot 3.generasjons tjenester. SAML-token hentes fra STS på Datapower ved
                            å sende OIDC-token dit.</p>
                    </div>
                    <div class="imageblock">
                        <div class="content">
                            <img alt="Singe Sign on" height="337"
                                 src="https://confluence.adeo.no/rest/gliffy/1.0/embeddedDiagrams/edc1c590-b2ac-421c-abf1-b08a991a2116.png"
                                 width="735">
                        </div>
                    </div>
                    <div class="olist arabic">
                        <ol class="arabic">
                            <li>
                                <p>Applikasjonen åpnes ved at brukeren går til hovedsiden, alternativt ved at det åpnes
                                    en lenke til applikasjonen. Alle sidene i applikasjonen er beskyttet.</p>
                                <div class="ulist">
                                    <ul>
                                        <li>
                                            <p>Nettleseren gjør kall mot serveren for å hente html-sider (og
                                                JavaScript-filer, bilder og lignende). Dersom applikasjonen samtidig er
                                                åpen i en annen fane, sendes cookie med OIDC-token med i kallet.</p>
                                        </li>
                                        <li>
                                            <p>Serveren validerer tokenet. Dersom tokenet mangler, hopp til punkt 2.
                                                Dersom tokenet er utløpt, eller ikke validerer OK av en eller annen
                                                grunn, hopp til punkt 5</p>
                                        </li>
                                        <li>
                                            <p>Når det er klart at serveren har et gyldig token fra brukeren, vil den
                                                gjennom sin egen PEP spørre PDP om aktuell operasjon er tillat å
                                                gjennomføre for brukeren. Dersom det ikke lar seg gjøre å få et gyldig
                                                token, skal serveren avbryte forespørselen umiddelbart.</p>
                                        </li>
                                        <li>
                                            <p>PDP vil da svare ja eller nei. Dersom aktuell operasjon ikke er lovlig,
                                                skal serveren avbryte forespørselsen umiddelbart.</p>
                                        </li>
                                    </ul>
                                </div>
                            </li>
                            <li>
                                <p>Håndtering av manglende OIDC-token</p>
                                <div class="ulist">
                                    <ul>
                                        <li>
                                            <p>Serveren lager en authorization request og sender denne til OpenAM ved å
                                                sende en redirect av nettleseren til OpenAMs påloggingsside</p>
                                        </li>
                                        <li>
                                            <p>Brukeren blir automatisk logget på med kerberos, alternativt oppgir
                                                brukernavn og passord.</p>
                                        </li>
                                        <li>
                                            <p>OpenAM svarer med en authorization_code, som den sender til serveren ved
                                                å gjøre redirect av nettleseren</p>
                                        </li>
                                        <li>
                                            <p>Serveren sender authorization_code til OpenAM</p>
                                        </li>
                                        <li>
                                            <p>Serveren får tilbake et OIDC-token og et refresh-token. Både OIDC-token
                                                og refresh-token settes som http-only cookie i nettleseren.</p>
                                        </li>
                                    </ul>
                                </div>
                            </li>
                            <li>
                                <p>Kall til andre REST-tjenester</p>
                                <div class="ulist">
                                    <ul>
                                        <li>
                                            <p>OIDC sendes med, slik at neste tjeneste kan gjøre sikkerhetssjekker</p>
                                        </li>
                                    </ul>
                                </div>
                            </li>
                            <li>
                                <p>Kall til 3.generasjons webtjenester</p>
                                <div class="ulist">
                                    <ul>
                                        <li>
                                            <p>OIDC sendes til Secure Token Service (STS) for å byttes til et
                                                SAML-token</p>
                                        </li>
                                        <li>
                                            <p>SAML dyttes inn SOAP-meldingen som så sendes til web-service.</p>
                                        </li>
                                    </ul>
                                </div>
                            </li>
                            <li>
                                <p>Håndtering av utløpt eller ikke-validerende OIDC-token</p>
                                <div class="ulist">
                                    <ul>
                                        <li>
                                            <p>Dersom det finnes et refresh-token, sendes det til OpenAM.</p>
                                        </li>
                                        <li>
                                            <p>OpenAM sender tilbake et nytt OIDC-token dersom refresh-tokenet er
                                                gyldig.</p>
                                        </li>
                                    </ul>
                                </div>
                            </li>
                        </ol>
                    </div>
                </div>
                <div class="sect3">
                    <h4 id="_flyt_av_tokens_og_autentiseringsinformasjon"><a class="anchor"
                                                                             href="#_flyt_av_tokens_og_autentiseringsinformasjon"></a><a
                            class="link" href="#_flyt_av_tokens_og_autentiseringsinformasjon">5.4.2. Flyt av tokens og
                        autentiseringsinformasjon</a></h4>
                    <div class="imageblock">
                        <div class="content">
                            <img alt="Autentisering" height="337"
                                 src="https://confluence.adeo.no/rest/gliffy/1.0/embeddedDiagrams/e72e3607-6814-48a1-9a50-3554e9eb7cc7.png"
                                 width="735">
                        </div>
                    </div>
                </div>
                <div class="sect3">
                    <h4 id="_sertifikathåndtering"><a class="anchor" href="#_sertifikathåndtering"></a><a class="link"
                                                                                                          href="#_sertifikathåndtering">5.4.3.
                        Sertifikathåndtering</a></h4>
                    <div class="paragraph">
                        <p>Applikasjonen trenger sertifikatet som OpenAM benytter for å signere OIDC. Dette henter<br>
                            applikasjonen fra OpenAM ved å gjøre HTTP-kall til riktig side.</p>
                    </div>
                </div>
                <div class="sect3">
                    <h4 id="_oppsett_av_web_xml"><a class="anchor" href="#_oppsett_av_web_xml"></a><a class="link"
                                                                                                      href="#_oppsett_av_web_xml">5.4.4.
                        Oppsett av web.xml</a></h4>
                    <div class="paragraph">
                        <p>I web.xml settes det opp hvilke sider som er beskyttet og hvilke sider som er åpne for
                            alle.<br>
                            For eksempelapplikasjonen er alle sider beskyttet, med unntak av self-test-siden (trengs for
                            deploy)<br>
                            og callback-siden som brukes for å hente OIDC-token første gang.</p>
                    </div>
                    <div class="listingblock">
                        <div class="title">web.xml i eksempelapplikasjonen</div>
                        <div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://java.sun.com/xml/ns/javaee"
         xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_1.xsd"
         metadata-complete="false"
         version="3.0"&gt;
&lt;!-- ... --&gt;
    &lt;security-constraint&gt;
        &lt;web-resource-collection&gt;
            &lt;web-resource-name&gt;Ubeskyttet&lt;/web-resource-name&gt;
            &lt;url-pattern&gt;/cb&lt;/url-pattern&gt;
            &lt;url-pattern&gt;/api/selftest&lt;/url-pattern&gt;
        &lt;/web-resource-collection&gt;
    &lt;/security-constraint&gt;
    &lt;security-constraint&gt;
        &lt;web-resource-collection&gt;
            &lt;web-resource-name&gt;Alt annet beskyttet&lt;/web-resource-name&gt;
            &lt;url-pattern&gt;/*&lt;/url-pattern&gt;
        &lt;/web-resource-collection&gt;
        &lt;auth-constraint&gt;
            &lt;!-- From Servlet spec 3.1 "**" means any authenticated user
            ref: https://community.oracle.com/blogs/swchan2/2013/04/19/role-servlet-31-security-constraint --&gt;
            &lt;role-name&gt;**&lt;/role-name&gt;
        &lt;/auth-constraint&gt;
    &lt;/security-constraint&gt;
&lt;!-- ... --&gt;
&lt;/web-app&gt;</code></pre>
                        </div>
                    </div>
                </div>
            </div>
            <div class="sect2">
                <h3 id="_roller_ad_grupper"><a class="anchor" href="#_roller_ad_grupper"></a><a class="link"
                                                                                                href="#_roller_ad_grupper">5.5.
                    Roller/AD-grupper</a></h3>
                <div class="paragraph">
                    <p>Tabellen inneholder de roller som er på plass i vedtaksløsningen for fundamentet.<br>
                        En bruker må ha en av grunnrollene for å få tilgang til løsningen. Tilleggsrollene gir
                        tilgang<br>
                        til mer informasjon eller funksjonalitet. Det er også definert noen tekniske roller som<br>
                        gir tilgang til køer og driftstjenester.</p>
                </div>
                <table class="tableblock frame-all grid-all spread">
                    <colgroup>
                        <col style="width: 33.3333%;">
                        <col style="width: 33.3333%;">
                        <col style="width: 33.3334%;">
                    </colgroup>
                    <thead>
                    <tr>
                        <th class="tableblock halign-left valign-top">Rolle</th>
                        <th class="tableblock halign-left valign-top">Beskrivelse</th>
                        <th class="tableblock halign-left valign-top">Type</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Saksbehandler</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Rollen som tildeles til
                            saksbehandlere på enheter som skal saksbehandle fagområder/ytelser som forvaltes i
                            Vedtaksløsning Foreldrepenger.</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Grunnrolle</p></td>
                    </tr>
                    <tr>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Veileder</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Rollen</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">som tildeles til interne
                            applikasjonsbrukere som har behovet for innsyn i saksopplysninger.</p></td>
                    </tr>
                    <tr>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Grunnrolle</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Manuelt overstyrer</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Tilleggsrolle som tildeles
                            de saksbehandlere som skal ha anledning til å overstyre maskinelle resultater. En slik
                            overstyring er ikke en del av generell saksbehandling (som f.eks. overstyring ved
                            skjønnsmessig behandling), men en tilleggsrolle for å kunne overstyre maskinelle resultater
                            som unntakshåndtering.</p></td>
                    </tr>
                    <tr>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Tilleggsrolle</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Beslutter</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Rollen som tildeles til de
                            saksbehandlere som skal gjennomføre totrinnskontroll (fatte vedtak).</p></td>
                    </tr>
                    <tr>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Tilleggsrolle</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Drift</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Rolle som tildeles
                            drifts-personell som benytter seg av RA brukere. Det er ikke noen begrensning på
                            diskresjonskode for disse brukene.</p></td>
                    </tr>
                    <tr>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Teknisk rolle</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">MQ skriv</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Rolle som gir bruker tilgang
                            til å legge inn meldinger på køer som eies av vedtaksløsningen</p></td>
                    </tr>
                    <tr>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Teknisk rolle</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">MQ les</p></td>
                        <td class="tableblock halign-left valign-top"><p class="tableblock">Rolle som gir bruker tilgang
                            til å hente ut meldinger på køer som eies av vedtaksløsningen</p></td>
                    </tr>
                    </tbody>
                </table>
                <div class="paragraph">
                    <p><strong>Merk:</strong><br>
                        Det legges ikke til grunn egne klageroller. Dette skal ivaretas gjennom saksbehandler og
                        beslutterrolle og tilhørende fordeling av oppgave til klageinstans.</p>
                </div>
                <div class="sect3">
                    <h4 id="_gruppenavn_i_ad"><a class="anchor" href="#_gruppenavn_i_ad"></a><a class="link"
                                                                                                href="#_gruppenavn_i_ad">5.5.1.
                        Gruppenavn i AD</a></h4>
                    <div class="ulist">
                        <ul>
                            <li>
                                <p>0000-GA-fpsak-saksbehandler</p>
                            </li>
                            <li>
                                <p>0000-GA-fpsak-veileder</p>
                            </li>
                            <li>
                                <p>0000-GA-fpsak-manuelt-overstyrer</p>
                            </li>
                            <li>
                                <p>0000-GA-fpsak-beslutter</p>
                            </li>
                            <li>
                                <p>0000-GA-fpsak-drift</p>
                            </li>
                            <li>
                                <p>0000-GA-fpsak-skriv</p>
                            </li>
                            <li>
                                <p>0000-GA-fpsak-les</p>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="sect3">
                    <h4 id="_fortrolig_kode_7_strengt_fortrolig_kode_6_og_egen_ansatt"><a class="anchor"
                                                                                          href="#_fortrolig_kode_7_strengt_fortrolig_kode_6_og_egen_ansatt"></a><a
                            class="link" href="#_fortrolig_kode_7_strengt_fortrolig_kode_6_og_egen_ansatt">5.5.2.
                        Fortrolig (Kode 7), Strengt fortrolig (Kode 6) og egen ansatt</a></h4>
                    <div class="paragraph">
                        <p>Tilleggsroller for disse kategoriene håndteres sentralt i nav. Saksbehandler i
                            vedtaksløsningen må ha en kombinasjon av roller listet over og det sentrale tilleggsrollene
                            under for å få tilgang til</p>
                    </div>
                    <div class="paragraph">
                        <p>Saksbehandlere som skal håndtere kode 6 har egne anonyme identer for dette.</p>
                    </div>
                    <table class="tableblock frame-all grid-all spread">
                        <colgroup>
                            <col style="width: 50%;">
                            <col style="width: 50%;">
                        </colgroup>
                        <tbody>
                        <tr>
                            <td class="tableblock halign-left valign-top"><p class="tableblock">Tillegsroller for
                                brukertilgang</p></td>
                            <td class="tableblock halign-left valign-top"><p class="tableblock">Beskrivelse</p></td>
                        </tr>
                        <tr>
                            <td class="tableblock halign-left valign-top"><p class="tableblock">Behandle trusselutsatte
                                brukere - strengt fortrolig (Kode 6)</p></td>
                            <td class="tableblock halign-left valign-top"><p class="tableblock">Tilleggsrolle som gir
                                brukere anledning til å behandle/få se opplysninger om trusselutsatte brukere som er
                                merket med kode 6. Lese eller skrivetilgang styres av applikasjons-rollene i listen
                                over.</p></td>
                        </tr>
                        <tr>
                            <td class="tableblock halign-left valign-top"><p class="tableblock">Behandle trusselutsatte
                                brukere - fortrolig (Kode 7)</p></td>
                            <td class="tableblock halign-left valign-top"><p class="tableblock">Tilleggsrolle som gir
                                brukere anledning til å behandle/få se opplysninger om trusselutsatte brukere som er
                                merket med kode 7. Lese eller skrivetilgang styres av applikasjons-rollene i listen
                                over.</p></td>
                        </tr>
                        <tr>
                            <td class="tableblock halign-left valign-top"><p class="tableblock">Behandle egne
                                ansatte</p></td>
                            <td class="tableblock halign-left valign-top"><p class="tableblock">Tilleggsrettigheten gir
                                de aktuelle rollene anledning til å behandle saker for brukere som er markert som ansatt
                                i egen enhet/NAV.</p></td>
                        </tr>
                        </tbody>
                    </table>
                </div>
                <div class="sect3">
                    <h4 id="_gruppenavn_i_ad_2"><a class="anchor" href="#_gruppenavn_i_ad_2"></a><a class="link"
                                                                                                    href="#_gruppenavn_i_ad_2">5.5.3.
                        Gruppenavn i AD</a></h4>
                    <div class="ulist">
                        <ul>
                            <li>
                                <p>0000-GA-GOSYS_KODE6</p>
                            </li>
                            <li>
                                <p>0000-GA-GOSYS_KODE7</p>
                            </li>
                            <li>
                                <p>000-GA-GOSYS_UTVIDET</p>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="sect3">
                    <h4 id="_andre_ad_grupper_bruker_må_være_meldt_inn_i"><a class="anchor"
                                                                             href="#_andre_ad_grupper_bruker_må_være_meldt_inn_i"></a><a
                            class="link" href="#_andre_ad_grupper_bruker_må_være_meldt_inn_i">5.5.4. Andre AD grupper
                        bruker må være meldt inn i</a></h4>
                    <div class="paragraph">
                        <p>Vedtaksløsningen benytter seg av tjenester i flere kringliggende systemer og
                            brukere/saksbehandlere må være meldt inn flere grupper for å få tilgang til disse.</p>
                    </div>
                    <div class="ulist">
                        <ul>
                            <li>
                                <p>0000-GA-INNTK</p>
                            </li>
                            <li>
                                <p>0000-GA-INNTK_FORELDRE</p>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="sect2">
                <h3 id="_vurdering_av_kvalitetskrav"><a class="anchor" href="#_vurdering_av_kvalitetskrav"></a><a
                        class="link" href="#_vurdering_av_kvalitetskrav">5.6. Vurdering av kvalitetskrav</a></h3>
                <div class="paragraph">
                    <p>Standardtekst for vurdering av kvalitetskrav;</p>
                </div>
                <div class="ulist">
                    <ul>
                        <li>
                            <p>Beskyttelse mot OWASP top 10 håndteres i egen teknisk epos.</p>
                        </li>
                        <li>
                            <p>Sikkerhetstesting håndteres med Appscan i hver sprint.</p>
                        </li>
                        <li>
                            <p>Tilgangskontroll håndteres med ABAC løsningen og PEP:er plasseres på metoder nær
                                kilden.</p>
                        </li>
                        <li>
                            <p>Sporbarhet håndteres i egen epos.</p>
                        </li>
                        <li>
                            <p>personlige brukere og systembrukere skal autentiseres mot sentral løsning føre de får
                                tilgang til informasjon.</p>
                        </li>
                        <li>
                            <p>Når infomasjon lagres til db skal også gyldighet og og når informasjonen ble endret
                                lagres</p>
                        </li>
                        <li>
                            <p>Det skal utføres en fullstendighetskontroll på data når denne hentes fra et
                                kildesystem</p>
                        </li>
                        <li>
                            <p>Input validering håndteres i teknisk epos for OWASP</p>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    <div class="sect1">
        <h2 id="_monitorering"><a class="anchor" href="#_monitorering"></a><a class="link" href="#_monitorering">6.
            Monitorering</a></h2>
        <div class="sectionbody">
            <div class="sect2">
                <h3 id="_logging"><a class="anchor" href="#_logging"></a><a class="link" href="#_logging">6.1.
                    Logging</a></h3>
                <div class="sect3">
                    <h4 id="_retningslinjer_for_logging"><a class="anchor" href="#_retningslinjer_for_logging"></a><a
                            class="link" href="#_retningslinjer_for_logging">6.1.1. Retningslinjer for Logging</a></h4>
                    <div class="paragraph">
                        <p>Applikasjonen logger hendelser utfra Auras retningslinjer i <a
                                href="https://confluence.adeo.no/display/AURA/Logging">Logging</a> og <a
                                href="https://confluence.adeo.no/display/AURA/Logback">Logback</a>.</p>
                    </div>
                    <div class="paragraph">
                        <p>Applikasjonen skriver foreløpig kun til disse log-typene:</p>
                    </div>
                    <table class="tableblock frame-all grid-all spread">
                        <colgroup>
                            <col style="width: 33.3333%;">
                            <col style="width: 33.3333%;">
                            <col style="width: 33.3334%;">
                        </colgroup>
                        <thead>
                        <tr>
                            <th class="tableblock halign-left valign-top">Loggtype</th>
                            <th class="tableblock halign-left valign-top">Beskrivelse</th>
                            <th class="tableblock halign-left valign-top">Loggdestinasjon</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr>
                            <td class="tableblock halign-left valign-top"><p class="tableblock">
                                Driftslogging/error-logg</p></td>
                            <td class="tableblock halign-left valign-top"><p class="tableblock">Tekniske problemer som
                                må løses av drift. Det er her viktigt at ikke annen informasjon er inkludert da drift
                                ikke ønsker å se alle detaljer i applikasjonenen.<br>
                                <br>
                                Dette er konfigurert til å være loggnivå ERROR fra applikasjonsloggen.</p></td>
                            <td class="tableblock halign-left valign-top"><p class="tableblock">/var/log/apps/&lt;appnavn&gt;_error.log</p>
                            </td>
                        </tr>
                        <tr>
                            <td class="tableblock halign-left valign-top"><p class="tableblock">Applikasjonslogging</p>
                            </td>
                            <td class="tableblock halign-left valign-top"><p class="tableblock">Mer detaljert
                                informasjon om det som skjer i applikasjonen. Den som leser denne har sannsynligvis
                                erfaring fra design og implementasjon av applikasjonen, og innholdet skal hjelpe til med
                                problemsøking.<br>
                                <br>
                                Se også Aura retningslinjer for Logging ang. loggnivåer for bakgrunn.<br>
                                <br>
                                <strong>NB: Funksjonelle feil skal IKKE logges til applikasjonsloggen, kun tekniske
                                    feil, advarsler eller informasjon om teknisk fremdrift i systemet</strong><br>
                                <br>
                                <strong>NB: Debug logging bør minimeres. Det er tildels tillatt å logge saks og person
                                    informasjon på DEBUG i testmiljøer, men siden vi p.t. ikke har vasking av dette også
                                    dersom det skulle komme i produksjon (f.eks. ved feilsøking), bør det holdes på et
                                    minimum</strong></p></td>
                            <td class="tableblock halign-left valign-top"><p class="tableblock">/var/log/apps/&lt;appnavn&gt;.log</p>
                            </td>
                        </tr>
                        <tr>
                            <td class="tableblock halign-left valign-top"><p class="tableblock">Sporbarhetslogging</p>
                            </td>
                            <td class="tableblock halign-left valign-top"><p class="tableblock">Følgende logges i
                                sporingsloggen:<br>
                                Manglende tilgang. Når en bruker forsøker å gjøre en operasjon, men mangler tilgang. Det
                                logges da at tilgang ikke ble gitt (deny), brukerident for brukeren, hvilken operasjon
                                som ble utført, og hvilke attributter som ble sendt til PDP.<br>
                                <br>
                                Lesing av data. Det logges brukerident for brukeren, hvilken leseoperasjon som er kalt,
                                en rekke metadata som beskriver hva som ble lest (for eksempel fødselsnumre, saksnummer)<br>
                                <br>
                                Utføring av skriveoperasjon. Det logges brukerident for brukeren, hvilken
                                skriveoperasjon som er kalt, en rekke metadata som beskriver hva som ble modifisert (for
                                eksempel fødselsnumre, saksnummer, behandlingUuid, aksjonspunktId)</p></td>
                            <td class="tableblock halign-left valign-top"><p class="tableblock">/var/log/apps/&lt;appnavn&gt;_sporing.log</p>
                            </td>
                        </tr>
                        <tr>
                            <td class="tableblock halign-left valign-top"><p class="tableblock">Sikkerhetslogg</p></td>
                            <td class="tableblock halign-left valign-top"><p class="tableblock">NB: Håndteres kun av
                                OpenAM<br>
                                <br>
                                Sikkerhetsrelatert informasjon: pålogging av bruker, endring av tilgang, forsøk å få
                                tilgang etc</p></td>
                            <td class="tableblock halign-left valign-top"><p class="tableblock">/var/log/apps/&lt;appnavn&gt;_sikkerhet.log</p>
                            </td>
                        </tr>
                        <tr>
                            <td class="tableblock halign-left valign-top"><p class="tableblock">Serverlogger</p></td>
                            <td class="tableblock halign-left valign-top"><p class="tableblock">Systemlogger for
                                applikasjonstjeneren (SystemOut, SystemErr, GC-logger ol.)</p></td>
                            <td class="tableblock halign-left valign-top"><p class="tableblock">/var/log/apps/&lt;appnavn&gt;/server/</p>
                            </td>
                        </tr>
                        <tr>
                            <td class="tableblock halign-left valign-top"><p class="tableblock">Logging av
                                tjenestekall</p></td>
                            <td class="tableblock halign-left valign-top"><p class="tableblock">P.T. IKKE I BRUK<br>
                                Ref: Aura - <a href="https://confluence.adeo.no/display/AURA/Logging+av+tjenestekall">Logging
                                    av tjenestekall</a></p></td>
                            <td class="tableblock halign-left valign-top"><p class="tableblock">/var/log/apps/&lt;appnavn&gt;/batch/&lt;batchnavn&gt;</p>
                            </td>
                        </tr>
                        <tr>
                            <td class="tableblock halign-left valign-top"><p class="tableblock">Batchlogging</p></td>
                            <td class="tableblock halign-left valign-top"><p class="tableblock">P.T. IKKE I BRUK -
                                AKTUELT FOR NYE BATCHER?<br>
                                <br>
                                Logging av normale hendelser som start/stop for batch, samt mer detaljert debug<br>
                                <br>
                                Ref: Aura - <a href="https://confluence.adeo.no/display/AURA/Logging">Logging</a></p>
                            </td>
                            <td class="tableblock halign-left valign-top"><p class="tableblock">/var/log/apps/&lt;appnavn&gt;/batch/&lt;batchnavn&gt;</p>
                            </td>
                        </tr>
                        <tr>
                            <td class="tableblock halign-left valign-top"><p class="tableblock">Batchklientlogging</p>
                            </td>
                            <td class="tableblock halign-left valign-top"><p class="tableblock">P.T. IKKE I BRUK -
                                AKTUELT FOR NYE BATCHER?<br>
                                <br>
                                Logging fra batchklienten, typisk feil hvis den ikke klarer å starte batchen<br>
                                <br>
                                Ref: Aura - <a href="https://confluence.adeo.no/display/AURA/Logging">Logging</a></p>
                            </td>
                            <td class="tableblock halign-left valign-top"><p class="tableblock">/var/log/apps/&lt;appnavn&gt;/batchklient</p>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
                <div class="sect3">
                    <h4 id="_logging_på_info_nivå"><a class="anchor" href="#_logging_på_info_nivå"></a><a class="link"
                                                                                                          href="#_logging_på_info_nivå">6.1.2.
                        Logging på INFO nivå</a></h4>
                    <div class="paragraph">
                        <p>Informasjon som logges her på INFO nivå skal kun inneholde nøkler som ikke er
                            personopplysninger.</p>
                    </div>
                    <div class="paragraph">
                        <p>INFO kan benyttes til å logge oppstart/stopp av applikasjonen, samt forretningsmessig
                            fremdrift (eks. behandlingssteg). Det bør ikke brukes til å logge tjenestekall (når dette
                            inneholder fulle request/respons dataobjekter)</p>
                    </div>
                    <div class="paragraph">
                        <p>Informasjon om tilstandstransisjoner (eks. behandlingssteg) eller tjeneste kall skal logges i
                            definerte Choke points i applikasjonen og ikke spres utover forretningskoden.</p>
                    </div>
                    <div class="paragraph">
                        <p><strong>Følgende nøkler er whitelistet</strong></p>
                    </div>
                    <div class="ulist">
                        <ul>
                            <li>
                                <p>BehandlingsId</p>
                            </li>
                            <li>
                                <p>FagsakId</p>
                            </li>
                            <li>
                                <p>Saksnummer (GSAK)</p>
                            </li>
                            <li>
                                <p>Oppgave id (GSAK)</p>
                            </li>
                            <li>
                                <p>JournalpostId</p>
                            </li>
                            <li>
                                <p>PDP resultat</p>
                            </li>
                            <li>
                                <p>Prosess task kode og id</p>
                            </li>
                            <li>
                                <p>Behandlingssteg</p>
                            </li>
                            <li>
                                <p>Kodeverk, eks:</p>
                                <div class="ulist">
                                    <ul>
                                        <li>
                                            <p>behandlingssteg</p>
                                        </li>
                                        <li>
                                            <p>aksjonspunkt</p>
                                        </li>
                                        <li>
                                            <p>vurderingspunkt</p>
                                        </li>
                                        <li>
                                            <p>etc</p>
                                        </li>
                                    </ul>
                                </div>
                            </li>
                            <li>
                                <p>Nøkler brukt i utveksling mot andre systemer for korrelering som ikke er knyttet
                                    direkte til person: eks. mot Oppdrag system, Dokprod</p>
                            </li>
                        </ul>
                    </div>
                    <div class="paragraph">
                        <p><strong>Følgende er eksempler personopplysninger som ikke skal logges her</strong></p>
                    </div>
                    <div class="ulist">
                        <ul>
                            <li>
                                <p>Meldinger</p>
                            </li>
                            <li>
                                <p>Aktør id</p>
                            </li>
                            <li>
                                <p>Fødselsnummer</p>
                            </li>
                            <li>
                                <p>Navn</p>
                            </li>
                            <li>
                                <p>Adresse</p>
                            </li>
                            <li>
                                <p>Barn</p>
                            </li>
                            <li>
                                <p>Søknad</p>
                            </li>
                            <li>
                                <p>Foreldre</p>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="sect3">
                    <h4 id="_logging_på_warn_nivå"><a class="anchor" href="#_logging_på_warn_nivå"></a><a class="link"
                                                                                                          href="#_logging_på_warn_nivå">6.1.3.
                        Logging på WARN nivå</a></h4>
                    <div class="paragraph">
                        <p>Logging på WARN nivå dekker situasjoner der en feil oppstår, men systemet fortsatt vil
                            fungere. Gjelder også feil på meldinger eller forbigående feil som påvirker enkeltsaker,
                            eller tilgang til grensesnitt som er midlertid utilgjengelig (inklusiv transiente feil mot
                            databasen)</p>
                    </div>
                    <div class="paragraph">
                        <p>I tillegg til underliggende feilmelding (cause) bør kontekst informasjon som f.eks
                            nøkkelverdier (ref: Applikasjonslogg) eller lignende logges.</p>
                    </div>
                </div>
                <div class="sect3">
                    <h4 id="_logging_på_error_nivå"><a class="anchor" href="#_logging_på_error_nivå"></a><a class="link"
                                                                                                            href="#_logging_på_error_nivå">6.1.4.
                        Logging på ERROR nivå</a></h4>
                    <div class="paragraph">
                        <p>Logging på ERROR nivå dekker kritiske feil som oppstår i systemet, som er fatale for videre
                            framdrift. Det kan være konfigurasjonsfeil, fatale databasefeil, eller feil i format på
                            meldinger mottatt eller grensesnitt.</p>
                    </div>
                    <div class="paragraph">
                        <p>I tillegg til underliggende feilmelding (cause) bør kontekst informasjon som f.eks
                            nøkkelverdier (ref: Applikasjonslogg) eller lignende logges.</p>
                    </div>
                    <div class="paragraph">
                        <p>Som en syretest på om noe bør logges som ERROR (istdf WARN), sett deg i mottakerens ståsted
                            og vurder om det er en feil det er verdt å vekke noen om natten for, eller om det kan vente
                            til neste forretningsdag.</p>
                    </div>
                </div>
                <div class="sect3">
                    <h4 id="_sporbarhetslogging"><a class="anchor" href="#_sporbarhetslogging"></a><a class="link"
                                                                                                      href="#_sporbarhetslogging">6.1.5.
                        Sporbarhetslogging</a></h4>
                    <div class="paragraph">
                        <p>Logging til sporingsloggen gjøres automatisk av løsningen for endepunkter som har
                            tilgangskontoroll, og automatikken dekker de fleste behov rundt dette (Se
                            BeskyttetRessursInterceptor.java).</p>
                    </div>
                    <div class="listingblock">
                        <div class="title">Normalt kommer sporingslogg ved å legge på tilgangskontroll slik</div>
                        <div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@BeskyttetRessurs(action = READ, ressurs = FAGSAK)
public List&lt;FagsakDto&gt; søkFagsaker(/*...*/)
/*...*/</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>I tilfellene det er behov for å logge mer enn hva som kommer fra
                            tilgangskontroll-attributtene, må endepunktet logge direkte:<br>
                            .Eksempel på ekstra-logging fra et endepunkt</p>
                    </div>
                    <div class="listingblock">
                        <div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">String actionType = "read";
String endepunkt = "/api/eksempel/fagsak";
Sporingsdata sporingsdata = Sporingsdata.opprett().leggTilId(SporingsloggId.FAGSAK_ID, fagsakId);
SporingsloggHelper.logSporing(ProsessTaskRestTjeneste.class, sporingsdata, actionType, endepunkt);</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>I tilfellene det er behov for å logge mer enn hva som kommer fra
                            tilgangskontroll-attributtene, må endepunktet logge direkte:</p>
                    </div>
                    <div class="listingblock">
                        <div class="title">Unnta operasjon fra sporingslogg slik</div>
                        <div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@BeskyttetRessurs(action = READ, ressurs = APPLIKASJON, sporingslogg = false)
public Map&lt;String, Object&gt; hentGruppertKodeliste()
/*...*/</code></pre>
                        </div>
                    </div>
                    <div class="paragraph">
                        <p>Sporingsloggen skal være beskyttet, da den inneholder fødselsnumre.</p>
                    </div>
                </div>
                <div class="sect3">
                    <h4 id="_kontekst_informasjon_for_logging"><a class="anchor"
                                                                  href="#_kontekst_informasjon_for_logging"></a><a
                            class="link" href="#_kontekst_informasjon_for_logging">6.1.6. Kontekst informasjon for
                        logging</a></h4>
                    <div class="paragraph">
                        <p>Applikasjonen setter MDC verdier for bruker-id og call-id ved inngangen til alle HTTP
                            requests, samt kjøring av Tasks og mottak av meldinger.</p>
                    </div>
                    <div class="paragraph">
                        <p>Disse verdiene skrives i alle log-innslag, og formidles videre i kall til SOAP-baserte web
                            services.</p>
                    </div>
                </div>
                <div class="sect3">
                    <h4 id="_oppstartsinformasjon"><a class="anchor" href="#_oppstartsinformasjon"></a><a class="link"
                                                                                                          href="#_oppstartsinformasjon">6.1.7.
                        Oppstartsinformasjon</a></h4>
                    <div class="paragraph">
                        <p>Applikasjonen logger denne informasjonen (til applikasjonslog) ved oppstart:</p>
                    </div>
                    <div class="ulist">
                        <ul>
                            <li>
                                <p>Alle Java system properties (med passord maskert)</p>
                            </li>
                            <li>
                                <p>Alle miljøvariabler (med passord maskert)</p>
                            </li>
                            <li>
                                <p>Resultatene av en selftest</p>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="sect3">
                    <h4 id="_teknisk_2"><a class="anchor" href="#_teknisk_2"></a><a class="link" href="#_teknisk_2">6.1.8.
                        Teknisk</a></h4>
                    <div class="paragraph">
                        <p>Logging håndteres gjennom logback-rammeverket, som implementer slf4j sitt standard-api.
                            Rammeverket konfigureres gjennom logback.xml som må ligge på classpath. For deployering mot
                            Jboss er dette lagt inn i modul build-config. Loggingen kan overvåkes av sentral ELK-stakk
                            som vist i ELK - miljøversikt</p>
                    </div>
                    <div class="paragraph">
                        <p>For lokal testkjøring brukes en egen logback.fil, logback-test.xml.</p>
                    </div>
                    <div class="imageblock">
                        <div class="content">
                            <img alt="Logging" height="337"
                                 src="https://confluence.adeo.no/rest/gliffy/1.0/embeddedDiagrams/b61c9700-f480-4670-a50e-ed8868c3ced9.png"
                                 width="735">
                        </div>
                    </div>
                </div>
            </div>
            <div class="sect2">
                <h3 id="_overvåkning"><a class="anchor" href="#_overvåkning"></a><a class="link" href="#_overvåkning">6.2.
                    Overvåkning</a></h3>
                <div class="paragraph">
                    <p>Vedtaksløsningen eksponerer interne REST-ressurser for overvåkning. Disse er:</p>
                </div>
                <div class="sect3">
                    <h4 id="_selftest"><a class="anchor" href="#_selftest"></a><a class="link" href="#_selftest">6.2.1.
                        Selftest</a></h4>
                    <div class="paragraph">
                        <p>/vedtak/internal/selftest</p>
                    </div>
                    <div class="paragraph">
                        <p>Støtter AURAs konsept om Selftest, og denne statusen kan sjekkes i FASIT. Sjekker at
                            applikasjonens webserver er oppe, og at den kan nå:</p>
                    </div>
                    <div class="ulist">
                        <ul>
                            <li>
                                <p>databasen</p>
                            </li>
                            <li>
                                <p>alle web services som applikasjonen bruker</p>
                            </li>
                            <li>
                                <p>alle meldingskøer som applikasjonen bruker</p>
                            </li>
                            <li>
                                <p>OpenAM ISSO</p>
                            </li>
                            <li>
                                <p>LDAP-integrasjon mot AD</p>
                            </li>
                        </ul>
                    </div>
                    <div class="paragraph">
                        <p>URLen leverer JSON til REST-klienter.</p>
                    </div>
                    <div class="paragraph">
                        <p>URLen kan også brukes fra nettleser, og vil da levere HTML. Hvis man legger til URL parameter
                            json=true, så vil den levere pretty-printed JSON til nettleser.</p>
                    </div>
                </div>
                <div class="sect3">
                    <h4 id="_metrikker"><a class="anchor" href="#_metrikker"></a><a class="link" href="#_metrikker">6.2.2.
                        Metrikker</a></h4>
                    <div class="paragraph">
                        <p>/vedtak/internal/metrics</p>
                    </div>
                    <div class="paragraph">
                        <p>Støtter AURAs konsept om Monitorering (SLAM) - (*S*entralisert *L*øsning for
                            *A*pplikasjons*m*etrikker/monitorering). Siden måler responstiden for REST-forespørslene.
                            Kan brukes av verktøy som Grafana for å monitorere ytelse.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <h1 class="sect0" id="_database"><a class="anchor" href="#_database"></a><a class="link"
                                                                                href="#_database">Database</a></h1>
    <div class="sect1">
        <h2 id="_diagrammer"><a class="anchor" href="#_diagrammer"></a><a class="link" href="#_diagrammer">7.
            Diagrammer</a></h2>
        <div class="sectionbody">
            <div class="paragraph">
                <p>Unresolved directive in database.adoc -
                    include::C:\git\vl-meldingshub\docs/generated/jdbc.adoc[leveloffset=0]</p>
            </div>
        </div>
    </div>
    <h1 class="sect0" id="_konfigurasjon"><a class="anchor" href="#_konfigurasjon"></a><a class="link"
                                                                                          href="#_konfigurasjon">Konfigurasjon</a>
    </h1>
    <div class="openblock partintro">
        <div class="content">
            <div class="paragraph">
                <p>Klassen KonfigVerdi gir sømløs tilgang til verdier fra system properties eller database.<br>
                    Klassen KonfigVerdiProvider står for konvertering fra tekst til Java typer, med typekontroll og
                    feilhåndtering</p>
            </div>
            <div class="paragraph">
                <p>Konfigurasjonsnøkler benyttet i koden. Konfigurasjonsverdiene vil komme fra FASIT (injisert gjennom
                    System.properties), eller leses fra VL-databasen.</p>
            </div>
            <div class="paragraph">
                <p>Unresolved directive in konfig.adoc - include::C:\git\vl-meldingshub\docs/generated/konfig.adoc[]<br>
                    :numbered:<br>
                    = Feilmeldinger</p>
            </div>
            <div class="paragraph">
                <p>Feilkoder angir unike og stabile referanser til feil som kan oppstå.<br>
                    Tekniske feil logges bare på angitt nivå, men vises med redusert tekst til brukere av systemet
                    sammen med callId.</p>
            </div>
            <div class="paragraph">
                <p>Funksjonelle feil logges ikke dersom feilmelding gis direkte til bruker.</p>
            </div>
            <div class="paragraph">
                <p>Unresolved directive in feilmeldinger.adoc -
                    include::C:\git\vl-meldingshub\docs/generated/feil.adoc[leveloffset=0]<br>
                    :numbered:</p>
            </div>
        </div>
    </div>
</div>
<div id="footer">
    <div id="footer-text">
        Version 1.0-SNAPSHOT<br>
        Last updated 2018-11-08 17:06:04 CET
    </div>
</div>
</body>
</html>
